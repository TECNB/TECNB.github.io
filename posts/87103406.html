<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>学工部就业相关网站项目经验 | TEC</title><meta name="author" content="TEC"><meta name="copyright" content="TEC"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="element plus地点选择器参考链接：https:&#x2F;&#x2F;blog.csdn.net&#x2F;m0_63209237&#x2F;article&#x2F;details&#x2F;134030737 value为string数组 第一步，安装中国全省市区的数据 1sudo npm install element-china-area-data -S  第二步，在要使用地址选择器的页面导入数据 1234567import &amp;#123;">
<meta property="og:type" content="article">
<meta property="og:title" content="学工部就业相关网站项目经验">
<meta property="og:url" content="https://tecnb.github.io/posts/87103406.html">
<meta property="og:site_name" content="TEC">
<meta property="og:description" content="element plus地点选择器参考链接：https:&#x2F;&#x2F;blog.csdn.net&#x2F;m0_63209237&#x2F;article&#x2F;details&#x2F;134030737 value为string数组 第一步，安装中国全省市区的数据 1sudo npm install element-china-area-data -S  第二步，在要使用地址选择器的页面导入数据 1234567import &amp;#123;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/TECNB/picgodemo@main/img/wallhaven-3l65w9_2560x1440.png">
<meta property="article:published_time" content="2024-07-06T14:18:23.000Z">
<meta property="article:modified_time" content="2024-07-06T14:18:23.000Z">
<meta property="article:author" content="TEC">
<meta property="article:tag" content="TEC">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/TECNB/picgodemo@main/img/wallhaven-3l65w9_2560x1440.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://tecnb.github.io/posts/87103406"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="baidu-site-verification" content="code-EeDq654IWe"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '学工部就业相关网站项目经验',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-06 22:18:23'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/universe.css"><link rel="stylesheet" href="/css/custom.css"  media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/iconfont/iconfont.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/TECNB/picgodemo@main/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">31</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background: default_top_img"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">TEC</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">学工部就业相关网站项目经验</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-07-06T14:18:23.000Z" title="发表于 2024-07-06 22:18:23">2024-07-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-07-06T14:18:23.000Z" title="更新于 2024-07-06 22:18:23">2024-07-06</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">16.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>84分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="学工部就业相关网站项目经验"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="element-plus地点选择器"><a href="#element-plus地点选择器" class="headerlink" title="element plus地点选择器"></a>element plus地点选择器</h1><p>参考链接：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/m0_63209237/article/details/134030737">https://blog.csdn.net/m0_63209237/article/details/134030737</a></p>
<p>value为string数组</p>
<p>第一步，安装中国全省市区的数据</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install element-china-area-data -S</span><br></pre></td></tr></table></figure>

<p>第二步，在要使用地址选择器的页面导入数据</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  provinceAndCityData,</span><br><span class="line">  pcTextArr,</span><br><span class="line">  regionData,</span><br><span class="line">  pcaTextArr,</span><br><span class="line">  codeToText,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;element-china-area-data&quot;</span>;</span><br></pre></td></tr></table></figure>


<p>导入数据说明：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">provinceAndCityData：省市二级联动数据,汉字+code</span><br><span class="line">regionData：省市区三级联动数据</span><br><span class="line">pcTextArr：省市联动数据，纯汉字</span><br><span class="line">pcaTextArr：省市区联动数据，纯汉字</span><br><span class="line">codeToText：是个大对象，属性是区域码，属性值是汉字 用法例如：codeToText[<span class="string">&#x27;110000&#x27;</span>]输出北京市</span><br></pre></td></tr></table></figure>

<p>html 部分</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;el-cascader</span><br><span class="line">      size=&quot;large&quot;</span><br><span class="line">      :options=&quot;pcaTextArr&quot;</span><br><span class="line">      v-model=&quot;area&quot; </span><br><span class="line">      placeholder=&quot;请点击选择区域&quot;&gt;</span><br><span class="line">    &lt;/el-cascader&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>js 部分</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; pcaTextArr &#125; <span class="keyword">from</span> <span class="string">&#x27;element-china-area-data&#x27;</span></span><br><span class="line"><span class="keyword">const</span> area = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>





<h1 id="MP-分页实现"><a href="#MP-分页实现" class="headerlink" title="MP 分页实现"></a>MP 分页实现</h1><p>访问：<a target="_blank" rel="noopener external nofollow noreferrer" href="http://localhost:8080/activity?page=1&amp;size=1">http://localhost:8080/activity?page=1&amp;size=1</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过构建一个分页查询接口，实现获取activity表中所有数据的接口</span></span><br><span class="line"><span class="meta">@GetMapping</span></span><br><span class="line"><span class="keyword">public</span> R&lt;Page&lt;Activity&gt;&gt; <span class="title function_">getAll</span><span class="params">(<span class="meta">@RequestParam(defaultValue = &quot;1&quot;)</span> <span class="type">int</span> page,</span></span><br><span class="line"><span class="params">                                    <span class="meta">@RequestParam(defaultValue = &quot;10&quot;)</span> <span class="type">int</span> size)</span> &#123;</span><br><span class="line">  <span class="comment">// 创建分页对象</span></span><br><span class="line">  Page&lt;Activity&gt; activityPage = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(page, size);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 使用 MyBatis Plus 进行分页查询</span></span><br><span class="line">  Page&lt;Activity&gt; result = activityService.page(activityPage);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> R.ok(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意需要加配置项</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">        interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>());</span><br><span class="line">        <span class="keyword">return</span> interceptor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="日历实现"><a href="#日历实现" class="headerlink" title="日历实现"></a>日历实现</h1><p><strong>功能描述</strong></p>
<p>在日历中展示未来的活动，使用变深颜色标记有活动的日期。当点击该日期时，显示活动详情，包括活动名称、时间和地点。</p>
<p><strong>实现步骤</strong></p>
<p>​	1.	<strong>活动日期的标记：</strong></p>
<p>​	•	在每个日期单元格中，判断该日期是否有活动。</p>
<p>​	•	如果该日期有活动，将日期单元格的背景颜色变深（如#BFDFFF），设置成圆形，并将文字变为白色，以示区分。</p>
<p>​	•	当日期处于当前月，透明度为1；否则，透明度减半（0.5）。</p>
<p>​	2.	<strong>日期点击触发活动详情展示：</strong></p>
<p>​	•	点击某一日期后，检查是否有活动数据。</p>
<p>​	•	如果该日期有活动数据，切换 Popover 的显示状态，以展示活动信息；如果无活动数据，则隐藏 Popover。</p>
<p>​	3.	<strong>Popover 组件用于显示活动详细信息：</strong></p>
<p>​	•	弹出活动详情，包含：</p>
<p>​	•	<strong>活动名称</strong>：以粗体显示。</p>
<p>​	•	<strong>活动时间</strong>：以本地时间格式显示（格式：年-月-日 时:分:秒）。</p>
<p>​	•	<strong>活动地点</strong>：显示活动举办地点。</p>
<p>​	•	Popover 弹出位置为下方（placement&#x3D;”bottom”），宽度设置为200px，并且不使用teleport，以避免重定位。</p>
<p>​	4.	<strong>数据加载和格式化：</strong></p>
<p>​	•	在组件挂载时调用getAllActivity接口，加载所有活动数据。</p>
<p>​	•	将活动按日期（startTime字段的日期部分）分组存储到activityByDate中，便于按日期查询活动。</p>
<p>​	5.	<strong>关键变量</strong></p>
<p>​	•	activityByDate：按日期组织的活动数据对象，结构为 { [key: string]: Activity[] }。</p>
<p>​	•	popoverVisible：记录每个日期是否显示活动详情 Popover 的布尔状态。</p>
<p><strong>代码说明</strong></p>
<p>​	•	<code>&lt;el-calendar&gt;</code> 组件展示日历，并通过 #date-cell 插槽自定义日期单元格。</p>
<p>​	•	handleDateClick 函数切换 Popover 的显示状态。</p>
<p>​	•	getAllActivity 异步获取活动数据，并处理数据格式。</p>
<p>​	•	Activity 接口定义了活动对象的基本信息，包括 id、name、startTime、place 等字段。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;pt-10 px-10&quot;&gt;</span><br><span class="line">        &lt;el-calendar&gt;</span><br><span class="line">            &lt;!-- 自定义日期单元格 --&gt;</span><br><span class="line">            &lt;template #date-cell=&quot;&#123; data &#125;&quot;&gt;</span><br><span class="line">                &lt;div :style=&quot;&#123;</span><br><span class="line">                    backgroundColor: activityByDate[data.day] ? &#x27;#BFDFFF&#x27; : &#x27;&#x27;,</span><br><span class="line">                    color: activityByDate[data.day] ? &#x27;white&#x27; : &#x27;&#x27;,</span><br><span class="line">                    opacity: data.type === &#x27;current-month&#x27; ? 1 : 0.5,</span><br><span class="line">                    width: &#x27;100%&#x27;,</span><br><span class="line">                    height: &#x27;100%&#x27;,</span><br><span class="line">                    display: &#x27;flex&#x27;,</span><br><span class="line">                    alignItems: &#x27;center&#x27;,</span><br><span class="line">                    justifyContent: &#x27;center&#x27;,</span><br><span class="line">                    cursor: &#x27;pointer&#x27;,</span><br><span class="line">                    position: &#x27;relative&#x27;</span><br><span class="line">                &#125;&quot; @click=&quot;handleDateClick(data.day)&quot;&gt;</span><br><span class="line">                    &#123;&#123; data.day.split(&#x27;-&#x27;)[2] &#125;&#125; &lt;!-- 显示日期的日部分 --&gt;</span><br><span class="line"></span><br><span class="line">                    &lt;!-- 动态 Popover 展示活动信息 --&gt;</span><br><span class="line">                    &lt;el-popover</span><br><span class="line">                        v-if=&quot;popoverVisible[data.day]&quot;</span><br><span class="line">                        v-model:visible=&quot;popoverVisible[data.day]&quot;</span><br><span class="line">                        width=&quot;100%&quot;</span><br><span class="line">                        :teleported=&quot;false&quot;</span><br><span class="line">                    &gt;</span><br><span class="line">                        &lt;div v-for=&quot;activity in activityByDate[data.day]&quot; :key=&quot;activity.id&quot;&gt;</span><br><span class="line">                            &lt;p&gt;&lt;strong&gt;&#123;&#123; activity.name &#125;&#125;&lt;/strong&gt;&lt;/p&gt;</span><br><span class="line">                            &lt;p&gt;时间: &#123;&#123; new Date(activity.startTime).toLocaleString() &#125;&#125;&lt;/p&gt;</span><br><span class="line">                            &lt;p&gt;地点: &#123;&#123; activity.place &#125;&#125;&lt;/p&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/el-popover&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">        &lt;/el-calendar&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref, onMounted &#125; from &#x27;vue&#x27;;</span><br><span class="line">import &#123; ElMessage &#125; from &#x27;element-plus&#x27;;</span><br><span class="line"></span><br><span class="line">import &#123; Activity &#125; from &#x27;../interfaces/Activity&#x27;;</span><br><span class="line">import &#123; getAllActivity &#125; from &#x27;../api/activity&#x27;;</span><br><span class="line"></span><br><span class="line">const loading = ref(false);</span><br><span class="line">const allData = ref&lt;Activity[]&gt;([]);</span><br><span class="line">const activityByDate = ref&lt;&#123; [key: string]: Activity[] &#125;&gt;(&#123;&#125;);</span><br><span class="line">const popoverVisible = ref&lt;&#123; [key: string]: boolean &#125;&gt;(&#123;&#125;);</span><br><span class="line"></span><br><span class="line">onMounted(async () =&gt; &#123;</span><br><span class="line">    loading.value = true;</span><br><span class="line">    try &#123;</span><br><span class="line">        const res = await getAllActivity();</span><br><span class="line">        allData.value = res.data.records;</span><br><span class="line"></span><br><span class="line">        // 按日期字符串组织活动</span><br><span class="line">        allData.value.forEach((activity) =&gt; &#123;</span><br><span class="line">            const date = activity.startTime.split(&#x27;T&#x27;)[0];</span><br><span class="line">            if (!activityByDate.value[date]) &#123;</span><br><span class="line">                activityByDate.value[date] = [];</span><br><span class="line">            &#125;</span><br><span class="line">            activityByDate.value[date].push(activity);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; catch (error) &#123;</span><br><span class="line">        ElMessage.error(&#x27;加载活动数据失败&#x27;);</span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">        loading.value = false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 点击日期显示活动详情的 Popover</span><br><span class="line">const handleDateClick = (day: string) =&gt; &#123;</span><br><span class="line">    if (activityByDate.value[day]) &#123;</span><br><span class="line">        // 切换 Popover 可见状态</span><br><span class="line">        popoverVisible.value[day] = !popoverVisible.value[day];</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        popoverVisible.value[day] = false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="日期不显示"><a href="#日期不显示" class="headerlink" title="日期不显示"></a>日期不显示</h2><ol>
<li>一开始将date作为Date类型使用，准备用解析日期的方式获取<code>yyyy-MM-dd</code>格式的数据，但是实际上EP已经准备了对应的插槽数据，date底下就有一个<code>.day</code>属性，格式好了所有的日期</li>
<li>date-cell插槽中数据的是固定的，就你说使用data，而不是date，否则会获取不到数据(类型：{ data: { type: ‘prev-month’ | ‘current-month’ | ‘next-month’, isSelected: boolean, day: string, date: Date } })</li>
</ol>
<h2 id="el-popover位置错位问题"><a href="#el-popover位置错位问题" class="headerlink" title="el-popover位置错位问题"></a>el-popover位置错位问题</h2><p>需要将需要定位的元素作为relative，并将el-popover移动至元素下面（其实一般是使用插槽去实现，但是会与日历组件冲突）、开启teleported，最大的踩坑点在于需要是<code>:teleported</code>，冒号是不能忘记的</p>
<h1 id="上传获取图片"><a href="#上传获取图片" class="headerlink" title="上传获取图片"></a>上传获取图片</h1><p>首先代码</p>
<p>将文件目录作为静态资源路径，以便可以通过 URL 访问到上传的图片。可以在 Spring Boot 的配置文件中指定静态资源路径。</p>
<p>在 Spring Boot 的配置文件中定义上传目录的路径，方便管理和更改。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">web:</span></span><br><span class="line">    <span class="attr">resources:</span></span><br><span class="line">      <span class="attr">static-locations:</span> <span class="string">file:/Users/tec/Desktop/</span></span><br><span class="line"></span><br><span class="line"><span class="attr">file:</span></span><br><span class="line">  <span class="attr">upload-dir:</span> <span class="string">/Users/tec/Desktop</span></span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tec.campuscareerbackend.controller;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> com.tec.campuscareerbackend.common.R;</span><br><span class="line"><span class="keyword">import</span> com.tec.campuscareerbackend.entity.Activity;</span><br><span class="line"><span class="keyword">import</span> com.tec.campuscareerbackend.service.IActivityService;</span><br><span class="line"><span class="keyword">import</span> jakarta.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 活动信息表 前端控制器</span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TECNB</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2024-10-31</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/activity&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ActivityController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义文件存储的目录路径（可以通过 application.yml 或 application.properties 配置）</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;file.upload-dir&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String uploadDir;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> IActivityService activityService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 上传活动照片到服务器</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/file&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> R&lt;String&gt; <span class="title function_">uploadFile</span><span class="params">(<span class="meta">@RequestParam(&quot;file&quot;)</span> MultipartFile file)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (file.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> R.error(<span class="string">&quot;文件不能为空&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 创建上传目录（如果不存在）</span></span><br><span class="line">            <span class="type">File</span> <span class="variable">dir</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(uploadDir);</span><br><span class="line">            <span class="keyword">if</span> (!dir.exists()) &#123;</span><br><span class="line">                dir.mkdirs();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 保存文件到指定目录</span></span><br><span class="line">            <span class="type">File</span> <span class="variable">uploadFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(dir, file.getOriginalFilename());</span><br><span class="line">            file.transferTo(uploadFile);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> R.ok(<span class="string">&quot;文件上传成功：&quot;</span> + uploadFile.getName());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> R.error(<span class="string">&quot;文件上传失败：&quot;</span> + e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>接着安全性考虑</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> &#123;</span><br><span class="line">        registry.addMapping(<span class="string">&quot;/**&quot;</span>) <span class="comment">// 匹配所有 URL 路径</span></span><br><span class="line">                .allowedOrigins(<span class="string">&quot;http://localhost:5173&quot;</span>) <span class="comment">// 允许的前端地址</span></span><br><span class="line">                .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;PUT&quot;</span>, <span class="string">&quot;DELETE&quot;</span>) <span class="comment">// 允许的请求方法</span></span><br><span class="line">                .allowedHeaders(<span class="string">&quot;*&quot;</span>) <span class="comment">// 允许的请求头</span></span><br><span class="line">                .allowCredentials(<span class="literal">true</span>) <span class="comment">// 允许携带 Cookie</span></span><br><span class="line">                .maxAge(<span class="number">3600</span>); <span class="comment">// 设置预检请求的缓存时间（单位：秒）</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="关联表"><a href="#关联表" class="headerlink" title="关联表"></a>关联表</h2><p>踩坑点在于必须使用<code>@TableField(exist = false)</code>禁止将该属性映射到数据库表中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode(callSuper = false)</span></span><br><span class="line"><span class="meta">@Accessors(chain = true)</span></span><br><span class="line"><span class="meta">@TableName(&quot;activity&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Activity</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 活动ID</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableId(value = &quot;id&quot;, type = IdType.AUTO)</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 活动图片链接</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String activityImage;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 存储活动的所有图片路径，不映射到数据库表</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableField(exist = false)</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; imagePaths;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="下载并打包为压缩包"><a href="#下载并打包为压缩包" class="headerlink" title="下载并打包为压缩包"></a>下载并打包为压缩包</h1><h2 id="文件名乱码问题"><a href="#文件名乱码问题" class="headerlink" title="文件名乱码问题"></a>文件名乱码问题</h2><p>不使用默认java提供的ZipArchiveOutputStream</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-compress<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/download&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseEntity&lt;ByteArrayResource&gt; <span class="title function_">downloadAttachmentsZip</span><span class="params">(<span class="meta">@RequestBody</span> EmploymentDatabase employmentDatabase)</span> &#123;</span><br><span class="line">    List&lt;EmploymentDatabaseAttachment&gt; urls = employmentDatabase.getAttachment();</span><br><span class="line"></span><br><span class="line">    <span class="type">ByteArrayOutputStream</span> <span class="variable">byteArrayOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">    <span class="keyword">try</span> (<span class="type">ZipArchiveOutputStream</span> <span class="variable">zipOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ZipArchiveOutputStream</span>(byteArrayOutputStream)) &#123;</span><br><span class="line">        <span class="comment">// 设置 ZipOutputStream 的编码为 UTF-8</span></span><br><span class="line">        zipOutputStream.setEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (EmploymentDatabaseAttachment url : urls) &#123;</span><br><span class="line">            <span class="type">URL</span> <span class="variable">fileUrl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(url.getFilePath());</span><br><span class="line">            <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> fileUrl.openStream()) &#123;</span><br><span class="line">                <span class="comment">// 使用 UTF-8 编码的文件名</span></span><br><span class="line">                <span class="type">ZipArchiveEntry</span> <span class="variable">entry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ZipArchiveEntry</span>(url.getFileName());</span><br><span class="line">                zipOutputStream.putArchiveEntry(entry);</span><br><span class="line"></span><br><span class="line">                <span class="type">byte</span>[] buffer = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">                <span class="type">int</span> len;</span><br><span class="line">                <span class="keyword">while</span> ((len = inputStream.read(buffer)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    zipOutputStream.write(buffer, <span class="number">0</span>, len);</span><br><span class="line">                &#125;</span><br><span class="line">                zipOutputStream.closeArchiveEntry();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">ByteArrayResource</span> <span class="variable">byteArrayResource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayResource</span>(byteArrayOutputStream.toByteArray());</span><br><span class="line">    <span class="type">HttpHeaders</span> <span class="variable">headers</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpHeaders</span>();</span><br><span class="line">    headers.add(HttpHeaders.CONTENT_DISPOSITION, <span class="string">&quot;attachment; filename=attachments.zip&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> ResponseEntity.ok()</span><br><span class="line">            .headers(headers)</span><br><span class="line">            .contentLength(byteArrayResource.contentLength())</span><br><span class="line">            .contentType(org.springframework.http.MediaType.APPLICATION_OCTET_STREAM)</span><br><span class="line">            .body(byteArrayResource);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="el-tree-select"><a href="#el-tree-select" class="headerlink" title="el-tree-select"></a>el-tree-select</h1><p>注意使用multiple可以多选，并且可以通过其他命令调整大标题是否可选</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 第六行 --&gt;</span><br><span class="line">&lt;div class=&quot;flex flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">            &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;网申链接：&lt;/p&gt;</span><br><span class="line">            &lt;el-input v-model=&quot;applicationLink&quot; placeholder=&quot;请输入链接&quot; /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">            &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;发送人群：&lt;/p&gt;</span><br><span class="line">            &lt;el-tree-select</span><br><span class="line">                v-model=&quot;targetAudience&quot;</span><br><span class="line">                :data=&quot;treeData&quot;</span><br><span class="line">                placeholder=&quot;请点击选择发送人群&quot;</span><br><span class="line">                size=&quot;large&quot;</span><br><span class="line">                clearable</span><br><span class="line">                :props=&quot;defaultProps&quot;</span><br><span class="line">                multiple</span><br><span class="line">                show-checkbox</span><br><span class="line">                collapse-tags</span><br><span class="line">                class=&quot;dynamic-height-select&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p>配置树状选择栏部分</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义目标受众的响应式变量</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> targetAudience = ref&lt;<span class="built_in">any</span>&gt;([]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义树形选择的数据结构</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> treeData = <span class="title function_">ref</span>([</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;21级本科&#x27;</span>,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;电子信息2101&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;电子信息2101&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;电子信息2102&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;电子信息2102&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;电子信息2103&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;电子信息2103&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;电子信息2104&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;电子信息2104&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;软件工程2101&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;软件工程2101&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;软件工程2102&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;软件工程2102&#x27;</span> &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;22级本科&#x27;</span>,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;电子信息2201&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;电子信息2201&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;电子信息2202&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;电子信息2202&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;电子信息2203&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;电子信息2203&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;电子信息2204&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;电子信息2204&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;软件工程2201&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;软件工程2201&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;软件工程2202&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;软件工程2202&#x27;</span> &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;23级本科&#x27;</span>,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;电子信息2301&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;电子信息2301&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;电子信息2302&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;电子信息2302&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;电子信息2303&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;电子信息2303&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;电子信息2304&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;电子信息2304&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;软件工程2301&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;软件工程2301&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;软件工程2302&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;软件工程2302&#x27;</span> &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">label</span>: <span class="string">&#x27;24级本科&#x27;</span>,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;电子信息2401&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;电子信息2401&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;电子信息2402&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;电子信息2402&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;电子信息2403&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;电子信息2403&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;电子信息2404&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;电子信息2404&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;软件工程2401&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;软件工程2401&#x27;</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">label</span>: <span class="string">&#x27;软件工程2402&#x27;</span>, <span class="attr">value</span>: <span class="string">&#x27;软件工程2402&#x27;</span> &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义 el-tree-select 的属性配置</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> defaultProps = &#123;</span><br><span class="line">    <span class="attr">children</span>: <span class="string">&#x27;children&#x27;</span>,</span><br><span class="line">    <span class="attr">label</span>: <span class="string">&#x27;label&#x27;</span>,</span><br><span class="line">    <span class="attr">value</span>: <span class="string">&#x27;value&#x27;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h1 id="通过key的方式对子组件强制渲染"><a href="#通过key的方式对子组件强制渲染" class="headerlink" title="通过key的方式对子组件强制渲染"></a>通过key的方式对子组件强制渲染</h1><p>参考：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.cnblogs.com/zhangycun/p/13268577.html">https://www.cnblogs.com/zhangycun/p/13268577.html</a></p>
<p>Vue 3 提供的响应式 API 可以通过事件触发和 ref 变量的方式更简洁地实现刷新操作，无需直接操作子组件的内部方法。你可以在父组件中使用状态（如refreshKey）来驱动子组件刷新。以下是这种更符合 Vue 3 哲学的实现方法：</p>
<ol>
<li><p><strong>在父组件中</strong>，定义一个 refreshKey 的 ref，并在上传成功后更改 refreshKey 的值，子组件会自动响应这个变化：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fileInput = ref&lt;<span class="title class_">HTMLInputElement</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"><span class="keyword">const</span> refreshKey = <span class="title function_">ref</span>(<span class="number">0</span>); <span class="comment">// 用于触发子组件重新渲染</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleFileUpload</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    fileInput.<span class="property">value</span>?.<span class="title function_">click</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onFileChange</span> = <span class="keyword">async</span> (<span class="params">event: Event</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> target = event.<span class="property">target</span> <span class="keyword">as</span> <span class="title class_">HTMLInputElement</span>;</span><br><span class="line">    <span class="keyword">const</span> file = target.<span class="property">files</span>?.[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span> (!file) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> formData = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line">    formData.<span class="title function_">append</span>(<span class="string">&#x27;file&#x27;</span>, file);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;http://localhost:5173/api/user-detail/importExcel&#x27;</span>, &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">            <span class="attr">body</span>: formData,</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (response.<span class="property">ok</span>) &#123;</span><br><span class="line">            <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(<span class="string">&#x27;文件上传成功！&#x27;</span>);</span><br><span class="line">            refreshKey.<span class="property">value</span> += <span class="number">1</span>; <span class="comment">// 上传成功后更改 refreshKey 值，触发子组件刷新</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&#x27;文件上传失败，请重试！&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&#x27;上传过程中出现错误！&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>在模板中</strong>，将 refreshKey 传递给 <code>&lt;UserDetailTable&gt; </code>组件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;UserDetailTable :key=&quot;refreshKey&quot; :dateOrder=&quot;dateOrder&quot; :typeOrder=&quot;typeOrder&quot; /&gt;</span><br><span class="line">&lt;input type=&quot;file&quot; ref=&quot;fileInput&quot; @change=&quot;onFileChange&quot; accept=&quot;.xls, .xlsx&quot; style=&quot;display: none&quot; /&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>在</strong> <code>&lt;UserDetailTable&gt;</code> <strong>子组件中</strong>，每次接收到新的 key 值时会自动重新加载，因此你只需要在 onMounted 钩子中调用 fetchTableData：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">fetchTableData</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    loading.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">getAllUserDetails</span>();</span><br><span class="line">        tableData.<span class="property">value</span> = response.<span class="property">data</span>;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        loading.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">onMounted</span>(fetchTableData); <span class="comment">// 页面加载时获取数据</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>通过更改 key 值，Vue 会自动重新渲染 <code>&lt;UserDetailTable&gt; </code>组件，这样可以避免直接调用子组件方法，保持代码更加简洁。</p>
<h1 id="手机适配"><a href="#手机适配" class="headerlink" title="手机适配"></a>手机适配</h1><p>参考链接：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://juejin.cn/post/7265129339195424827">https://juejin.cn/post/7265129339195424827</a></p>
<h2 id="taliwincss-常用样式"><a href="#taliwincss-常用样式" class="headerlink" title="taliwincss 常用样式"></a>taliwincss 常用样式</h2><p>踩坑点主要有需要加上<code>!</code>增加其样式的优先级，以及 elementui 部分的内含样式太多，不好轻易改，所以通过媒体查询+v-if的方式去进行手机的适配</p>
<p>手机存在，大屏幕不存在</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">class=<span class="string">&quot;!hidden md:!block&quot;</span></span><br></pre></td></tr></table></figure>

<p>字体调整</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">class=<span class="string">&quot;md:text-4xl font-extrabold text-3xl&quot;</span></span><br></pre></td></tr></table></figure>

<p>IndexView.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;IndexView flex p-0 md:p-5&quot;&gt;</span><br><span class="line">        &lt;!-- 仅在大屏幕上显示 sidebar (大于md) --&gt;</span><br><span class="line">        &lt;div class=&quot;min-w-52 hidden md:block&quot;&gt;</span><br><span class="line">            &lt;Sidebar device=&quot;pc&quot;/&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;md:w-[86%] w-full h-full&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;&quot;&gt;</span><br><span class="line">                &lt;Header /&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;h-[93%]&quot;&gt;</span><br><span class="line">                &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import Sidebar from &#x27;../components/Sidebar.vue&#x27;</span><br><span class="line">// 引入Header</span><br><span class="line">import Header from &#x27;../components/Header.vue&#x27;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.IndexView &#123;</span><br><span class="line">    height: 100vh;</span><br><span class="line">    background: #F2F8FC;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>slider转为点击图标出现菜单</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;Header rounded-none md:rounded-2xl md:mx-6 md:mb-6 m-0 px-5&quot;&gt;</span><br><span class="line">        &lt;el-icon size=&quot;20&quot; class=&quot;!block md:!hidden mr-2&quot; @click=&quot;showSlider&quot;&gt;</span><br><span class="line">                &lt;Menu/&gt;</span><br><span class="line">            &lt;/el-icon&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Sidebar device=&quot;phone&quot; v-if=&quot;ifShowSidebar&quot;/&gt;</span><br><span class="line">        &lt;MaskLayer :ifShow=&quot;ifShowSidebar&quot; @click=&quot;showSlider&quot;/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>



<h2 id="媒体查询"><a href="#媒体查询" class="headerlink" title="媒体查询"></a>媒体查询</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-scrollbar height=&quot;100%&quot;&gt;</span><br><span class="line">    &lt;el-table :data=&quot;tableData&quot; class=&quot;tableBox&quot; table-layout=&quot;fixed&quot; @selection-change=&quot;handleSelectionChange&quot;</span><br><span class="line">      v-loading=&quot;loading&quot; :row-style=&quot;&#123; height: &#x27;80px&#x27; &#125;&quot;&gt;</span><br><span class="line">      &lt;!-- v-if实现隐藏和显示的逻辑 --&gt;</span><br><span class="line">      &lt;el-table-column</span><br><span class="line">        v-if=&quot;isMediumScreen&quot;</span><br><span class="line">        type=&quot;selection&quot;</span><br><span class="line">        width=&quot;40&quot;</span><br><span class="line">        :class=&quot;&#123; &#x27;hidden-md&#x27;: !isMediumScreen &#125;&quot;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;/el-table&gt;</span><br><span class="line">  &lt;/el-scrollbar&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref, onMounted, onBeforeUnmount &#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">// 定义是否处于中等屏幕以上的状态</span><br><span class="line">const isMediumScreen = ref(false);</span><br><span class="line"></span><br><span class="line">// 更新屏幕宽度的响应式逻辑</span><br><span class="line">const updateScreenSize = () =&gt; &#123;</span><br><span class="line">  isMediumScreen.value = window.innerWidth &gt;= 768;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  updateScreenSize(); // 初始化时检查屏幕大小</span><br><span class="line">  window.addEventListener(&quot;resize&quot;, updateScreenSize); // 监听窗口变化</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">onBeforeUnmount(() =&gt; &#123;</span><br><span class="line">  window.removeEventListener(&quot;resize&quot;, updateScreenSize); // 组件卸载时移除监听器</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const handleSelectionChange = (selection: any) =&gt; &#123;</span><br><span class="line">  console.log(&quot;Selection changed:&quot;, selection);</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<h1 id="Vue-3-router-addroute-no-match-found"><a href="#Vue-3-router-addroute-no-match-found" class="headerlink" title="Vue 3 router addroute no match found"></a>Vue 3 router addroute no match found</h1><p>参考链接：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.jianshu.com/p/95569fd0b20a">https://www.jianshu.com/p/95569fd0b20a</a></p>
<p>原因：当 <code>name</code> 名相同时，后面的路由会覆盖前端的路由。</p>
<h1 id="easyexcel-报错ExceptionInInitializerError"><a href="#easyexcel-报错ExceptionInInitializerError" class="headerlink" title="easyexcel 报错ExceptionInInitializerError"></a>easyexcel 报错ExceptionInInitializerError</h1><p>参考链接：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/alibaba/easyexcel/issues/2040%E3%80%81https://github.com/alibaba/easyexcel/issues/2240">https://github.com/alibaba/easyexcel/issues/2040、https://github.com/alibaba/easyexcel/issues/2240</a></p>
<p>官网：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://easyexcel.opensource.alibaba.com/docs/current/quickstart/read">https://easyexcel.opensource.alibaba.com/docs/current/quickstart/read</a></p>
<p>原因：easyexcel 版本设定低了，应该按照下面版本，修复了在JDK17中的适配问题</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--表格导入--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>easyexcel<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="java自带ZipOutputStream压缩文件名为中文的乱码问题"><a href="#java自带ZipOutputStream压缩文件名为中文的乱码问题" class="headerlink" title="java自带ZipOutputStream压缩文件名为中文的乱码问题"></a>java自带ZipOutputStream压缩文件名为中文的乱码问题</h1><p>参考链接：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/cqstart116/article/details/44728821">https://blog.csdn.net/cqstart116/article/details/44728821</a></p>
<p>原因：java自带的工具就没有设定编码的功能，所以改用apache的工具</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 文件上传 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-compress<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>       </span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span>    </span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/employment-database&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmploymentDatabaseController</span> &#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> IEmploymentDatabaseService employmentDatabaseService;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> IEmploymentDatabaseAttachmentService employmentDatabaseAttachmentService; <span class="comment">// 用于保存附件路径</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/download&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;ByteArrayResource&gt; <span class="title function_">downloadAttachmentsZip</span><span class="params">(<span class="meta">@RequestBody</span> EmploymentDatabase employmentDatabase)</span> &#123;</span><br><span class="line">        List&lt;EmploymentDatabaseAttachment&gt; urls = employmentDatabase.getAttachment();</span><br><span class="line"></span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">byteArrayOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">ZipArchiveOutputStream</span> <span class="variable">zipOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ZipArchiveOutputStream</span>(byteArrayOutputStream)) &#123;</span><br><span class="line">            <span class="comment">// 设置 ZipOutputStream 的编码为 UTF-8</span></span><br><span class="line">            zipOutputStream.setEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (EmploymentDatabaseAttachment url : urls) &#123;</span><br><span class="line">                <span class="type">URL</span> <span class="variable">fileUrl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(url.getFilePath());</span><br><span class="line">                <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> fileUrl.openStream()) &#123;</span><br><span class="line">                    <span class="comment">// 使用 UTF-8 编码的文件名</span></span><br><span class="line">                    <span class="type">ZipArchiveEntry</span> <span class="variable">entry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ZipArchiveEntry</span>(url.getFileName());</span><br><span class="line">                    zipOutputStream.putArchiveEntry(entry);</span><br><span class="line"></span><br><span class="line">                    <span class="type">byte</span>[] buffer = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">                    <span class="type">int</span> len;</span><br><span class="line">                    <span class="keyword">while</span> ((len = inputStream.read(buffer)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                        zipOutputStream.write(buffer, <span class="number">0</span>, len);</span><br><span class="line">                    &#125;</span><br><span class="line">                    zipOutputStream.closeArchiveEntry();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">ByteArrayResource</span> <span class="variable">byteArrayResource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayResource</span>(byteArrayOutputStream.toByteArray());</span><br><span class="line">        <span class="type">HttpHeaders</span> <span class="variable">headers</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpHeaders</span>();</span><br><span class="line">        headers.add(HttpHeaders.CONTENT_DISPOSITION, <span class="string">&quot;attachment; filename=attachments.zip&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.ok()</span><br><span class="line">                .headers(headers)</span><br><span class="line">                .contentLength(byteArrayResource.contentLength())</span><br><span class="line">                .contentType(org.springframework.http.MediaType.APPLICATION_OCTET_STREAM)</span><br><span class="line">                .body(byteArrayResource);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="ElementPlus-upload-fileList为空"><a href="#ElementPlus-upload-fileList为空" class="headerlink" title="ElementPlus upload fileList为空"></a>ElementPlus upload fileList为空</h1><p>参考链接：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.sunzhongwei.com/vue-element-ui-upload-file-upload-component-after-file-list-is-empty-array">https://www.sunzhongwei.com/vue-element-ui-upload-file-upload-component-after-file-list-is-empty-array</a></p>
<ol>
<li><p>不使用 action 可以避免用户上传了图片，但是没保存表单，导致图片冗余的问题，但是实际上不使用 action fileList又为空，导致极难获取到上传到图片，所以这个还没有实现</p>
</li>
<li><p>使用 action 上传</p>
</li>
</ol>
<h1 id="带属性搜索"><a href="#带属性搜索" class="headerlink" title="带属性搜索"></a>带属性搜索</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/employment-database&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmploymentDatabaseController</span> &#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> IEmploymentDatabaseService employmentDatabaseService;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> IEmploymentDatabaseAttachmentService employmentDatabaseAttachmentService; <span class="comment">// 用于保存附件路径</span></span><br><span class="line">    <span class="comment">// 搜索就业信息</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/search&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> R&lt;Page&lt;EmploymentDatabase&gt;&gt; <span class="title function_">searchEmploymentDatabase</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam(required = false)</span> String filterField,</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam(required = false)</span> String filterValue,</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam</span> <span class="type">int</span> page,</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam</span> <span class="type">int</span> size)</span> &#123;</span><br><span class="line"></span><br><span class="line">        Page&lt;EmploymentDatabase&gt; employmentDatabasePage = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(page, size);</span><br><span class="line">        QueryWrapper&lt;EmploymentDatabase&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 根据字段名动态添加查询条件</span></span><br><span class="line">        <span class="keyword">if</span> (filterField != <span class="literal">null</span> &amp;&amp; filterValue != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (filterField) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;category&quot;</span>:</span><br><span class="line">                    queryWrapper.like(<span class="string">&quot;category&quot;</span>, filterValue);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;title&quot;</span>:</span><br><span class="line">                    queryWrapper.like(<span class="string">&quot;title&quot;</span>, filterValue);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;attachment&quot;</span>:</span><br><span class="line">                    queryWrapper.like(<span class="string">&quot;attachment&quot;</span>, filterValue);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;details&quot;</span>:</span><br><span class="line">                    queryWrapper.like(<span class="string">&quot;details&quot;</span>, filterValue);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;createdAt&quot;</span>:</span><br><span class="line">                    queryWrapper.like(<span class="string">&quot;created_at&quot;</span>, filterValue);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="keyword">return</span> R.error(<span class="string">&quot;无效的筛选字段&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Page&lt;EmploymentDatabase&gt; result = employmentDatabaseService.page(employmentDatabasePage, queryWrapper);</span><br><span class="line">        <span class="keyword">return</span> R.ok(result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="智能匹配岗位"><a href="#智能匹配岗位" class="headerlink" title="智能匹配岗位"></a>智能匹配岗位</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/job-search&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JobSearchController</span> &#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> IJobSearchService jobSearchService;</span><br><span class="line">    <span class="comment">// 智能匹配岗位接口，通过 studentId 获取 className 后再匹配岗位</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/match&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> R&lt;Page&lt;JobSearch&gt;&gt; <span class="title function_">matchJobsByStudentId</span><span class="params">(<span class="meta">@RequestParam</span> String studentId,</span></span><br><span class="line"><span class="params">                                                   <span class="meta">@RequestParam(defaultValue = &quot;1&quot;)</span> <span class="type">int</span> page,</span></span><br><span class="line"><span class="params">                                                   <span class="meta">@RequestParam(defaultValue = &quot;10&quot;)</span> <span class="type">int</span> size)</span> &#123;</span><br><span class="line">        Page&lt;JobSearch&gt; result = jobSearchService.matchJobsByStudentId(studentId, page, size);</span><br><span class="line">        <span class="keyword">return</span> R.ok(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="导入excel"><a href="#导入excel" class="headerlink" title="导入excel"></a>导入excel</h1><p><strong>关键实现步骤</strong></p>
<p>​	1.	<strong>上传文件</strong></p>
<p>​	•	使用 @RequestParam(“file”) MultipartFile file 接收用户上传的文件。</p>
<p>​	•	通过 file.getInputStream() 获取文件的输入流。</p>
<p>​	2.	<strong>读取 Excel 数据</strong></p>
<p>​	•	使用 <strong>EasyExcel</strong> 的 read 方法读取文件内容：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;UserDetailExcelDto&gt; userList = EasyExcel.read(file.getInputStream())</span><br><span class="line">    .head(UserDetailExcelDto.class)</span><br><span class="line">    .sheet()</span><br><span class="line">    .doReadSync();</span><br></pre></td></tr></table></figure>

<p>​	•	head(UserDetailExcelDto.class)：指定 Excel 数据对应的实体类 UserDetailExcelDto，表示每一行数据将被映射到该对象。</p>
<p>​	•	sheet()：默认读取第一个工作表。</p>
<p>​	•	doReadSync()：同步读取数据，结果存储为一个 List<UserDetailExcelDto>。</p>
<p>​	3.	<strong>数据校验和保存</strong></p>
<p>​	•	遍历 userList，对每条数据进行处理：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (UserDetailExcelDto dto : userList) &#123;</span><br><span class="line">  <span class="keyword">if</span> (dto.getName() == <span class="literal">null</span> || dto.getName().isEmpty()) &#123;</span><br><span class="line">    <span class="keyword">return</span> R.ok(<span class="string">&quot;导入成功&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​	•	检查关键字段（如 dto.getName()）是否为空，跳过空白行。</p>
<p>​	4.	<strong>保存到数据库</strong></p>
<p>​	•	<strong>保存到</strong> user_detail <strong>表</strong>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UserDetail</span> <span class="variable">userDetail</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserDetail</span>();</span><br><span class="line">userDetail.setName(dto.getName());</span><br><span class="line">userDetail.setGender(dto.getGender());</span><br><span class="line">userDetail.setClassName(dto.getClassName());</span><br><span class="line">userDetail.setStudentId(dto.getStudentId());</span><br><span class="line">userDetail.setContactNumber(dto.getContactNumber());</span><br><span class="line">userDetail.setClassTeacher(dto.getClassTeacher());</span><br><span class="line">userDetail.setGraduationTutor(dto.getGraduationTutor());</span><br><span class="line">userDetailService.save(userDetail);</span><br></pre></td></tr></table></figure>

<p>将 Excel 数据映射到 UserDetail 实体类，并调用 userDetailService.save 保存到数据库。</p>
<p>​	•	<strong>保存到</strong> users <strong>表</strong>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Users</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Users</span>();</span><br><span class="line">user.setStudentId(dto.getStudentId());</span><br><span class="line">user.setUsername(dto.getName());</span><br><span class="line"><span class="type">String</span> <span class="variable">initialPassword</span> <span class="operator">=</span> dto.getStudentId().substring(dto.getStudentId().length() - <span class="number">6</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">salt</span> <span class="operator">=</span> generateSalt();</span><br><span class="line"><span class="type">String</span> <span class="variable">passwordHash</span> <span class="operator">=</span> encryptHv(initialPassword, salt);</span><br><span class="line">user.setPasswordHash(passwordHash);</span><br><span class="line">user.setSalt(salt);</span><br><span class="line">user.setUserType(<span class="string">&quot;student&quot;</span>);</span><br><span class="line">user.setPhone(dto.getContactNumber());</span><br><span class="line">usersService.save(user);</span><br></pre></td></tr></table></figure>

<p>初始化用户账号信息：</p>
<p>​	•	生成默认密码：学号后 6 位。</p>
<p>​	•	调用加密方法 encryptHv 进行密码加密。</p>
<p>​	•	调用 usersService.save 保存到数据库。</p>
<p>完整代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user-detail&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDetailController</span> &#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> IUserDetailService userDetailService;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> IUsersService usersService;</span><br><span class="line">    <span class="meta">@PostMapping(&quot;/importExcel&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> R&lt;String&gt; <span class="title function_">importExcel</span><span class="params">(<span class="meta">@RequestParam(&quot;file&quot;)</span> MultipartFile file)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 读取Excel数据并过滤只获取需要的字段</span></span><br><span class="line">            List&lt;UserDetailExcelDto&gt; userList = EasyExcel.read(file.getInputStream())</span><br><span class="line">                    .head(UserDetailExcelDto.class)</span><br><span class="line">                    .sheet()</span><br><span class="line">                    .doReadSync();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (UserDetailExcelDto dto : userList) &#123;</span><br><span class="line">                <span class="comment">// 检查关键字段是否为空，判断是否为空白行</span></span><br><span class="line">                <span class="keyword">if</span> (dto.getName() == <span class="literal">null</span> || dto.getName().isEmpty()) &#123;</span><br><span class="line">                    <span class="comment">// 遇到空白行，跳出循环并返回成功</span></span><br><span class="line">                    <span class="keyword">return</span> R.ok(<span class="string">&quot;导入成功&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 保存到 user_detail 表</span></span><br><span class="line">                <span class="type">UserDetail</span> <span class="variable">userDetail</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserDetail</span>();</span><br><span class="line">                userDetail.setName(dto.getName());</span><br><span class="line">                userDetail.setGender(dto.getGender());</span><br><span class="line">                userDetail.setClassName(dto.getClassName());</span><br><span class="line">                userDetail.setStudentId(dto.getStudentId());</span><br><span class="line">                userDetail.setContactNumber(dto.getContactNumber());</span><br><span class="line">                userDetail.setClassTeacher(dto.getClassTeacher());</span><br><span class="line">                userDetail.setGraduationTutor(dto.getGraduationTutor());</span><br><span class="line">                userDetailService.save(userDetail);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 初始化保存到 users 表</span></span><br><span class="line">                <span class="type">Users</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Users</span>();</span><br><span class="line">                user.setStudentId(dto.getStudentId());</span><br><span class="line">                user.setUsername(dto.getName());</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 生成初始密码为学号后6位</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">initialPassword</span> <span class="operator">=</span> dto.getStudentId().substring(dto.getStudentId().length() - <span class="number">6</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">salt</span> <span class="operator">=</span> generateSalt();</span><br><span class="line">                <span class="type">String</span> <span class="variable">passwordHash</span> <span class="operator">=</span> encryptHv(initialPassword, salt);</span><br><span class="line"></span><br><span class="line">                user.setPasswordHash(passwordHash);</span><br><span class="line">                user.setSalt(salt);</span><br><span class="line">                user.setUserType(<span class="string">&quot;student&quot;</span>);</span><br><span class="line">                user.setPhone(dto.getContactNumber());</span><br><span class="line">                usersService.save(user);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> R.ok(<span class="string">&quot;导入成功&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> R.error(<span class="string">&quot;导入失败: &quot;</span> + e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="GPT新建表惯例"><a href="#GPT新建表惯例" class="headerlink" title="GPT新建表惯例"></a>GPT新建表惯例</h1><ol>
<li><p>请根据下面的表单，修改其表单字段名称，多余的属性删去，缺少的属性补上：</p>
</li>
<li><p>根据上面的字段为我创建一个名为conversation_records的数据表，请你把sql语句给我</p>
</li>
<li><p>请给我对应的rowjson，方便我测试添加接口，注意驼峰</p>
</li>
<li><p>请你参考下面的Dto，根据上面的字段编写一份ConversationRecordsExcelDto,多余的属性删去，缺少的属性补上：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDetailExcelDto</span> &#123;</span><br><span class="line">  <span class="meta">@ExcelProperty(&quot;姓名&quot;)</span></span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="meta">@ExcelProperty(&quot;性别&quot;)</span></span><br><span class="line">  <span class="keyword">private</span> String gender;</span><br><span class="line">  <span class="meta">@ExcelProperty(&quot;所在班级&quot;)</span></span><br><span class="line">  <span class="keyword">private</span> String className;</span><br><span class="line">  <span class="meta">@ExcelProperty(&quot;学号&quot;)</span></span><br><span class="line">  <span class="keyword">private</span> String studentId;</span><br><span class="line">  <span class="meta">@ExcelProperty(&quot;手机号码&quot;)</span></span><br><span class="line">  <span class="keyword">private</span> String contactNumber;</span><br><span class="line">  <span class="meta">@ExcelProperty(&quot;班主任&quot;)</span></span><br><span class="line">  <span class="keyword">private</span> String classTeacher;</span><br><span class="line">  <span class="meta">@ExcelProperty(&quot;导师&quot;)</span></span><br><span class="line">  <span class="keyword">private</span> String graduationTutor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>请你参考下面的importExcel接口，根据上面的字段编写一份新的接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/importExcel&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> R&lt;String&gt; <span class="title function_">importActivityTargetAudienceExcel</span><span class="params">(<span class="meta">@RequestParam(&quot;file&quot;)</span> MultipartFile file)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 使用 EasyExcel 读取 Excel 数据</span></span><br><span class="line">            List&lt;ActivityTargetAudienceExcelDto&gt; audienceList = EasyExcel.read(file.getInputStream())</span><br><span class="line">                    .head(ActivityTargetAudienceExcelDto.class)</span><br><span class="line">                    .sheet()</span><br><span class="line">                    .doReadSync();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 过滤掉空白行</span></span><br><span class="line">            List&lt;ActivityTargetAudienceExcelDto&gt; validAudienceList = audienceList.stream()</span><br><span class="line">                    .filter(dto -&gt; dto.getAudienceLabel() != <span class="literal">null</span> &amp;&amp; !dto.getAudienceLabel().isEmpty())</span><br><span class="line">                    .collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将 DTO 转换为实体列表</span></span><br><span class="line">            List&lt;ActivityTargetAudience&gt; audienceEntities = validAudienceList.stream().map(dto -&gt; &#123;</span><br><span class="line">                <span class="type">ActivityTargetAudience</span> <span class="variable">entity</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ActivityTargetAudience</span>();</span><br><span class="line">                entity.setId(dto.getId());</span><br><span class="line">                entity.setMajor(dto.getMajor());</span><br><span class="line">                entity.setAudienceLabel(dto.getAudienceLabel());</span><br><span class="line">                entity.setAudienceValue(dto.getAudienceValue());</span><br><span class="line">                <span class="keyword">return</span> entity;</span><br><span class="line">            &#125;).collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 批量保存或更新</span></span><br><span class="line">            <span class="keyword">if</span> (!audienceEntities.isEmpty()) &#123;</span><br><span class="line">                activityTargetAudienceService.saveOrUpdateBatch(audienceEntities);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> R.ok(<span class="string">&quot;导入成功&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> R.error(<span class="string">&quot;导入失败: &quot;</span> + e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="GPT新建表格导入规范惯例"><a href="#GPT新建表格导入规范惯例" class="headerlink" title="GPT新建表格导入规范惯例"></a>GPT新建表格导入规范惯例</h1><ol>
<li><p>我有一个excel导入数据库的功能，现在需要我为每个excel的每个标题定一个存入标准，防止存入时报错，请你根据字段以及对应sql语句，给我相关的文字标准描述：</p>
<p>序号	展位号	招聘企业	招聘岗位	HR名称	联系电话	所需专业	招聘人数	薪资待遇	地区	网申链接	其他要求	企业简介</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> job_search;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> job_search (</span><br><span class="line">  id <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;主键ID&#x27;</span>,</span><br><span class="line">  company_name <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;企业名称&#x27;</span>,</span><br><span class="line">  position_name <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;岗位名称&#x27;</span>,</span><br><span class="line">  hr_name <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;HR名称&#x27;</span>,</span><br><span class="line">  hr_phone <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;联系电话&#x27;</span>,</span><br><span class="line">  major_requirement <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;专业要求&#x27;</span>,</span><br><span class="line">  participant_count <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;招聘人数&#x27;</span>,</span><br><span class="line">  money <span class="type">varchar</span>(<span class="number">50</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;薪资待遇&#x27;</span>,</span><br><span class="line">  area <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;工作地点&#x27;</span>,</span><br><span class="line">  application_link text COMMENT <span class="string">&#x27;网申链接&#x27;</span>,</span><br><span class="line">  additional_requirements text COMMENT <span class="string">&#x27;其他要求&#x27;</span>,</span><br><span class="line">  company_description text COMMENT <span class="string">&#x27;企业简介&#x27;</span>,</span><br><span class="line">  created_at <span class="type">timestamp</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">  updated_at <span class="type">timestamp</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;更新时间&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (id)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">19</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci COMMENT<span class="operator">=</span><span class="string">&#x27;岗位发布详情表&#x27;</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>参考JobSearchExcellmportListener，为我编写一个ActivityTargetAudienceImportListener，错误消息要求逻辑为第2列班级必填、第3列专业名称必填且不允许出现“专升本”这三个字、第4列年级必填，且只能为数字，由于我的audienceValue存入时是string，具体的逻辑，可以是先尝试转化为Integer，如果失败则抛出然后存入错误：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JobSearchExcelImportListener</span> <span class="keyword">extends</span> <span class="title class_">AnalysisEventListener</span>&lt;JobSearchExcelDto&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> List&lt;JobSearchExcelDto&gt; jobList;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> List&lt;Map&lt;Integer, String&gt;&gt; errorDataList;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">JobSearchExcelImportListener</span><span class="params">(List&lt;JobSearchExcelDto&gt; jobList, List&lt;Map&lt;Integer, String&gt;&gt; errorDataList)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.jobList = jobList;</span><br><span class="line">        <span class="built_in">this</span>.errorDataList = errorDataList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">invoke</span><span class="params">(JobSearchExcelDto dto, AnalysisContext context)</span> &#123;</span><br><span class="line">        Map&lt;Integer, String&gt; errors = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 校验第 3 列: 招聘企业</span></span><br><span class="line">        <span class="keyword">if</span> (dto.getCompanyName() == <span class="literal">null</span> || dto.getCompanyName().isEmpty()) &#123;</span><br><span class="line">            errors.put(<span class="number">2</span>, <span class="string">&quot;招聘企业不能为空&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 校验第 4 列: 招聘岗位</span></span><br><span class="line">        <span class="keyword">if</span> (dto.getPositionName() == <span class="literal">null</span> || dto.getPositionName().isEmpty()) &#123;</span><br><span class="line">            errors.put(<span class="number">3</span>, <span class="string">&quot;招聘岗位不能为空&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 校验第 7 列: 所需专业</span></span><br><span class="line">        <span class="keyword">if</span> (dto.getMajorRequirement() == <span class="literal">null</span> || dto.getMajorRequirement().isEmpty()) &#123;</span><br><span class="line">            errors.put(<span class="number">6</span>, <span class="string">&quot;所需专业不能为空&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!Pattern.matches(<span class="string">&quot;^[\\w/\\u4e00-\\u9fa5]+$&quot;</span>, dto.getMajorRequirement())) &#123;</span><br><span class="line">            errors.put(<span class="number">6</span>, <span class="string">&quot;所需专业必须使用“/”分割&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 校验第 8 列: 招聘人数</span></span><br><span class="line">        <span class="keyword">if</span> (dto.getParticipantCount() == <span class="literal">null</span>) &#123;</span><br><span class="line">            errors.put(<span class="number">7</span>, <span class="string">&quot;招聘人数不能为空&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (dto.getParticipantCount() == <span class="number">0</span>) &#123;</span><br><span class="line">            errors.put(<span class="number">7</span>, <span class="string">&quot;招聘人数必须为数字整数&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 校验第 9 列: 薪资待遇</span></span><br><span class="line">        <span class="keyword">if</span> (dto.getMoney() == <span class="literal">null</span> || dto.getMoney().isEmpty()) &#123;</span><br><span class="line">            errors.put(<span class="number">8</span>, <span class="string">&quot;薪资待遇不能为空&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            List&lt;String&gt; validSalaries = Arrays.asList(<span class="string">&quot;2000-5000&quot;</span>, <span class="string">&quot;5000-8000&quot;</span>, <span class="string">&quot;8000-15000&quot;</span>, <span class="string">&quot;15000以上&quot;</span>,<span class="string">&quot;面议&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (!validSalaries.contains(dto.getMoney())) &#123;</span><br><span class="line">                errors.put(<span class="number">8</span>, <span class="string">&quot;薪资待遇格式错误，仅支持以下格式: 2000-5000, 5000-8000, 8000-15000, 15000以上, 面议&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 校验第 10 列: 地区</span></span><br><span class="line">        <span class="keyword">if</span> (dto.getArea() == <span class="literal">null</span> || dto.getArea().isEmpty()) &#123;</span><br><span class="line">            errors.put(<span class="number">9</span>, <span class="string">&quot;地区不能为空&quot;</span>);</span><br><span class="line">        &#125;  <span class="keyword">else</span> <span class="keyword">if</span> (!Pattern.matches(<span class="string">&quot;^[\\w,\\u4e00-\\u9fa5]+$&quot;</span>, dto.getArea())) &#123;</span><br><span class="line">            errors.put(<span class="number">9</span>, <span class="string">&quot;地区必须使用英文逗号分割&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 保存错误信息到 dto</span></span><br><span class="line">        dto.setErrorMessages(errors);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将 dto 和错误信息添加到列表</span></span><br><span class="line">        jobList.add(dto);</span><br><span class="line">        errorDataList.add(errors.isEmpty() ? <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;() : errors);  <span class="comment">// 确保每行都有一个 Map</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doAfterAllAnalysed</span><span class="params">(AnalysisContext context)</span> &#123;</span><br><span class="line">        <span class="comment">// 全部解析完成后的处理</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ActivityTargetAudienceExcelDto：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ActivityTargetAudienceExcelDto</span> &#123;</span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;序号&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;年级&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String audienceLabel;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;班级&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String audienceValue;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;专业名称&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String major;</span><br><span class="line">  </span><br><span class="line">  	<span class="meta">@ExcelIgnore</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;Integer, String&gt; errorMessages = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>参考JobSearchController的importExcel修改ActivityTargetAudienceController的importExcel</p>
<p>JobSearchController的importExcel：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/importExcel&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">importJobSearchExcel</span><span class="params">(<span class="meta">@RequestParam(&quot;file&quot;)</span> MultipartFile file, HttpServletResponse response)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 存储读取的数据和错误信息</span></span><br><span class="line">            List&lt;JobSearchExcelDto&gt; jobList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            List&lt;Map&lt;Integer, String&gt;&gt; errorDataList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 创建 ExcelImportListener</span></span><br><span class="line">            <span class="type">JobSearchExcelImportListener</span> <span class="variable">listener</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JobSearchExcelImportListener</span>(jobList, errorDataList);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 使用 EasyExcel 读取 Excel 数据，使用自定义监听器</span></span><br><span class="line">            EasyExcel.read(file.getInputStream(), JobSearchExcelDto.class, listener)</span><br><span class="line">                    .sheet()</span><br><span class="line">                    .doReadSync();  <span class="comment">// 使用同步读取方式，确保读取所有行</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果没有数据，则返回提示</span></span><br><span class="line">            <span class="keyword">if</span> (jobList.isEmpty()) &#123;</span><br><span class="line">                response.setContentType(<span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">                response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">                response.getWriter().write(<span class="string">&quot;&#123;\&quot;message\&quot;:\&quot;导入数据为空\&quot;&#125;&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 检查是否存在错误</span></span><br><span class="line">            <span class="type">boolean</span> <span class="variable">hasErrors</span> <span class="operator">=</span> jobList.stream()</span><br><span class="line">                    .anyMatch(dto -&gt; dto.getErrorMessages() != <span class="literal">null</span> &amp;&amp; !dto.getErrorMessages().isEmpty());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (hasErrors) &#123;</span><br><span class="line">                <span class="comment">// 如果有错误，生成错误文件并返回</span></span><br><span class="line">                response.setContentType(<span class="string">&quot;application/vnd.ms-excel&quot;</span>);</span><br><span class="line">                response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">                response.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment;filename=error_data.xlsx&quot;</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 调用 EasyExcel 写入错误数据</span></span><br><span class="line">                EasyExcel.write(response.getOutputStream(), JobSearchExcelDto.class)</span><br><span class="line">                        .registerWriteHandler(<span class="keyword">new</span> <span class="title class_">ErrorCellStyleHandler</span>(errorDataList))</span><br><span class="line">                        .sheet(<span class="string">&quot;错误数据&quot;</span>)</span><br><span class="line">                        .doWrite(jobList);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 使用 mapToJobSearch 将 DTO 转换为实体列表</span></span><br><span class="line">            List&lt;JobSearch&gt; jobEntities = jobList.stream()</span><br><span class="line">                    .map(<span class="built_in">this</span>::mapToJobSearch)  <span class="comment">// 调用 mapToJobSearch 方法</span></span><br><span class="line">                    .collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 批量保存或更新</span></span><br><span class="line">            <span class="keyword">if</span> (!jobEntities.isEmpty()) &#123;</span><br><span class="line">                jobSearchService.saveOrUpdateBatch(jobEntities);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 返回成功信息</span></span><br><span class="line">            response.setContentType(<span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">            response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">            response.getWriter().write(<span class="string">&quot;&#123;\&quot;message\&quot;:\&quot;导入成功\&quot;&#125;&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                response.setContentType(<span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">                response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">                response.getWriter().write(<span class="string">&quot;&#123;\&quot;message\&quot;:\&quot;导入失败: &quot;</span> + e.getMessage() + <span class="string">&quot;\&quot;&#125;&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException ioException) &#123;</span><br><span class="line">                ioException.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
<li></li>
</ol>
<h1 id="利用-CASE-语句，将-money-转换为数值后按从高到低排序"><a href="#利用-CASE-语句，将-money-转换为数值后按从高到低排序" class="headerlink" title="利用 CASE 语句，将 money 转换为数值后按从高到低排序"></a>利用 CASE 语句，将 money 转换为数值后按从高到低排序</h1><p>在代码中，CASE 语句用于将文字形式的薪资范围（如 “2000-5000”）转换为对应的数值，以便进行条件过滤和排序操作。以下是具体解析：</p>
<p><strong>CASE 语句基本结构</strong></p>
<p>CASE 是 SQL 中的一种条件表达式，类似于编程语言中的 if-else 或 switch-case，用于根据条件返回不同的值。</p>
<p>语法如下：</p>
<p>CASE</p>
<p>  WHEN condition1 THEN result1</p>
<p>  WHEN condition2 THEN result2</p>
<p>  …</p>
<p>  ELSE resultN</p>
<p>END</p>
<p>​	•	WHEN condition1 THEN result1：如果 condition1 为真，返回 result1。</p>
<p>​	•	ELSE resultN：当没有任何条件为真时，返回 resultN（可以省略）。</p>
<p>在我们的代码中，CASE 被用在 QueryWrapper.apply 和 orderByDesc 中。</p>
<p><strong>用法 1：映射薪资范围到数值</strong></p>
<p>queryWrapper.lambda()</p>
<p>  .apply(“CASE “ +</p>
<p>​      “WHEN money &#x3D; ‘2000-5000’ THEN 2000 “ +</p>
<p>​      “WHEN money &#x3D; ‘5000-8000’ THEN 5000 “ +</p>
<p>​      “WHEN money &#x3D; ‘8000-15000’ THEN 8000 “ +</p>
<p>​      “WHEN money &#x3D; ‘15000以上’ THEN 15000 “ +</p>
<p>​      “ELSE 0 END &gt;&#x3D; {0}”, lowSalaryValue);</p>
<p><strong>解析：</strong></p>
<p>​	1.	money &#x3D; ‘2000-5000’：</p>
<p>​	•	如果 JobSearch.money 为 “2000-5000”，返回 2000。</p>
<p>​	2.	money &#x3D; ‘5000-8000’：</p>
<p>​	•	如果 JobSearch.money 为 “5000-8000”，返回 5000。</p>
<p>​	3.	ELSE 0：</p>
<p>​	•	如果 JobSearch.money 的值不在已知范围内，返回 0。</p>
<p>最终，这段 CASE 的结果是一个整数值，可以用来和用户的最低薪资需求（lowSalaryValue）进行数值比较。</p>
<p>例如：如果用户的 lowSalaryValue 是 8000，那么查询条件会变成：</p>
<p>CASE</p>
<p>  WHEN money &#x3D; ‘2000-5000’ THEN 2000</p>
<p>  WHEN money &#x3D; ‘5000-8000’ THEN 5000</p>
<p>  WHEN money &#x3D; ‘8000-15000’ THEN 8000</p>
<p>  WHEN money &#x3D; ‘15000以上’ THEN 15000</p>
<p>  ELSE 0</p>
<p>END &gt;&#x3D; 8000</p>
<p>这将筛选出薪资范围为 “8000-15000” 和 “15000以上” 的数据。</p>
<p><strong>用法 2：排序</strong></p>
<p>queryWrapper.orderByDesc(“CASE “ +</p>
<p>​    “WHEN money &#x3D; ‘2000-5000’ THEN 2000 “ +</p>
<p>​    “WHEN money &#x3D; ‘5000-8000’ THEN 5000 “ +</p>
<p>​    “WHEN money &#x3D; ‘8000-15000’ THEN 8000 “ +</p>
<p>​    “WHEN money &#x3D; ‘15000以上’ THEN 15000 “ +</p>
<p>​    “ELSE 0 END”);</p>
<p><strong>解析：</strong></p>
<p>​	1.	CASE 的逻辑同上，将文字形式的 money 映射为可比较的数值。</p>
<p>​	2.	orderByDesc 按照这些数值从大到小排序。</p>
<p>例如：</p>
<p>​	•	“15000以上” -&gt; 15000</p>
<p>​	•	“8000-15000” -&gt; 8000</p>
<p>​	•	“5000-8000” -&gt; 5000</p>
<p>​	•	“2000-5000” -&gt; 2000</p>
<p>最终，结果将按这些映射值从高到低排序。</p>
<p><strong>SQL 执行逻辑示例</strong></p>
<p>假设表 JobSearch 中有如下数据：</p>
<p><strong>money</strong></p>
<p>2000-5000</p>
<p>5000-8000</p>
<p>8000-15000</p>
<p>15000以上</p>
<p>SQL 查询语句：</p>
<p>SELECT *</p>
<p>FROM JobSearch</p>
<p>WHERE </p>
<p>  CASE</p>
<p>​    WHEN money &#x3D; ‘2000-5000’ THEN 2000</p>
<p>​    WHEN money &#x3D; ‘5000-8000’ THEN 5000</p>
<p>​    WHEN money &#x3D; ‘8000-15000’ THEN 8000</p>
<p>​    WHEN money &#x3D; ‘15000以上’ THEN 15000</p>
<p>​    ELSE 0</p>
<p>  END &gt;&#x3D; 8000</p>
<p>ORDER BY</p>
<p>  CASE</p>
<p>​    WHEN money &#x3D; ‘2000-5000’ THEN 2000</p>
<p>​    WHEN money &#x3D; ‘5000-8000’ THEN 5000</p>
<p>​    WHEN money &#x3D; ‘8000-15000’ THEN 8000</p>
<p>​    WHEN money &#x3D; ‘15000以上’ THEN 15000</p>
<p>​    ELSE 0</p>
<p>  END DESC;</p>
<p>执行结果：</p>
<p>​	•	WHERE 过滤出 money &gt;&#x3D; 8000 的数据，即：”8000-15000” 和 “15000以上”。</p>
<p>​	•	ORDER BY 按映射值排序，最终结果：</p>
<p>​	1.	“15000以上”</p>
<p>​	2.	“8000-15000”</p>
<p><strong>总结</strong></p>
<p>​	•	CASE 用于将无法直接比较的文字形式数据（薪资范围）转换为数值。</p>
<p>​	•	筛选通过 CASE 结合 WHERE 实现。</p>
<p>​	•	排序通过 CASE 映射值结合 ORDER BY 实现。</p>
<p>​	•	这种方法兼容文字范围的动态映射，同时保留了高效的 SQL 查询能力。</p>
<h1 id="如何让item-title部分的p标签保持只有一行，多处一行的部分用…代替"><a href="#如何让item-title部分的p标签保持只有一行，多处一行的部分用…代替" class="headerlink" title="如何让item.title部分的p标签保持只有一行，多处一行的部分用…代替"></a>如何让item.title部分的p标签保持只有一行，多处一行的部分用…代替</h1><p><strong>Tailwind 的 truncate 类作用</strong></p>
<p>truncate 类的实际效果等同于以下 CSS：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">overflow</span>: hidden; <span class="comment">/* 超出部分隐藏 */</span></span><br><span class="line"><span class="attribute">text-overflow</span>: ellipsis; <span class="comment">/* 显示省略号 */</span></span><br><span class="line"><span class="attribute">white-space</span>: nowrap; <span class="comment">/* 文本不换行 */</span></span><br></pre></td></tr></table></figure>

<p><strong>效果</strong></p>
<p>​	1.	文本长度超过容器宽度时，会自动加上 …。</p>
<p>​	2.	文本强制保持单行，不会因为内容过多而换行。</p>
<p><strong>自定义宽度容器</strong></p>
<p>如果需要限制 title 的最大显示宽度以便触发省略号，可以添加 max-w-* 类。例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;text-lg text-blue-400 cursor-pointer hover:text-black truncate max-w-[200px]&quot;</span>&gt;</span></span><br><span class="line">  &#123;&#123; item.title &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>其中：</p>
<p>​	•	max-w-[200px]：限制最大宽度为 200px（可以根据设计需求调整）。</p>
<p>​	•	这将确保在宽度超过 200px 时文本溢出，触发省略号效果。</p>
<h1 id="esayexcel"><a href="#esayexcel" class="headerlink" title="esayexcel"></a>esayexcel</h1><h2 id="esayexcel导入失败"><a href="#esayexcel导入失败" class="headerlink" title="esayexcel导入失败"></a>esayexcel导入失败</h2><p>参考链接：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://segmentfault.com/q/1010000018526018">https://segmentfault.com/q/1010000018526018</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">导入失败: Text <span class="string">&#x27;2024-11-23&#x27;</span> could not be parsed: Unable to obtain LocalDateTime from TemporalAccessor: &#123;&#125;,ISO resolved to 2024-11-23 of <span class="built_in">type</span> java.time.format.Parsed</span><br></pre></td></tr></table></figure>

<p>导入失败原因：<code>LocalDateTime</code> 不能转换 <code>yyyy-MM-dd</code> 这种格式的字符串，LocalDateTime 是 LocalDate + LocalTime 两部分都得有，也就是说上面的格式字符串缺少了小时分钟以及秒，将类似的类型改为LocalDate就行</p>
<h2 id="esayexcel导出"><a href="#esayexcel导出" class="headerlink" title="esayexcel导出"></a>esayexcel导出</h2><p>后端接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/exportJobSearchExcel&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">exportJobSearchExcel</span><span class="params">(HttpServletResponse response)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 查询数据库中的 JobSearch 数据</span></span><br><span class="line">        List&lt;JobSearch&gt; jobSearchList = jobSearchService.list();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (jobSearchList.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;无数据可导出&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将实体对象转换为 DTO 对象</span></span><br><span class="line">        List&lt;JobSearchExcelDto&gt; jobSearchDtoList = jobSearchList.stream()</span><br><span class="line">                .map(<span class="built_in">this</span>::mapToJobSearchExcelDto)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置响应头，确保文件正确下载</span></span><br><span class="line">        response.setContentType(<span class="string">&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;</span>);</span><br><span class="line">        response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> URLEncoder.encode(<span class="string">&quot;求职信息&quot;</span>, <span class="string">&quot;UTF-8&quot;</span>).replaceAll(<span class="string">&quot;\\+&quot;</span>, <span class="string">&quot;%20&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment; filename*=UTF-8&#x27;&#x27;&quot;</span> + fileName + <span class="string">&quot;.xlsx&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用 EasyExcel 写入数据到响应流</span></span><br><span class="line">        EasyExcel.write(response.getOutputStream(), JobSearchExcelDto.class)</span><br><span class="line">                .sheet(<span class="string">&quot;求职信息&quot;</span>)</span><br><span class="line">                .doWrite(jobSearchDtoList);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 导出失败时返回 JSON 错误信息</span></span><br><span class="line">            response.setContentType(<span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">            response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">            response.getWriter().write(<span class="string">&quot;&#123;\&quot;message\&quot;:\&quot;导出失败: &quot;</span> + e.getMessage() + <span class="string">&quot;\&quot;&#125;&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException ioException) &#123;</span><br><span class="line">            ioException.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将 JobSearch 实体对象转换为 JobSearchExcelDto</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> JobSearchExcelDto <span class="title function_">mapToJobSearchExcelDto</span><span class="params">(JobSearch jobSearch)</span> &#123;</span><br><span class="line">    <span class="type">JobSearchExcelDto</span> <span class="variable">dto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JobSearchExcelDto</span>();</span><br><span class="line">    dto.setId(jobSearch.getId());</span><br><span class="line">    dto.setCompanyName(jobSearch.getCompanyName());</span><br><span class="line">    dto.setPositionName(jobSearch.getPositionName());</span><br><span class="line">    dto.setHrName(jobSearch.getHrName());</span><br><span class="line">    dto.setHrPhone(jobSearch.getHrPhone());</span><br><span class="line">    dto.setMajorRequirement(jobSearch.getMajorRequirement());</span><br><span class="line">    dto.setParticipantCount(jobSearch.getParticipantCount());</span><br><span class="line">    dto.setMoney(jobSearch.getMoney());</span><br><span class="line">    dto.setArea(jobSearch.getArea());</span><br><span class="line">    dto.setApplicationLink(jobSearch.getApplicationLink());</span><br><span class="line">    dto.setAdditionalRequirements(jobSearch.getAdditionalRequirements());</span><br><span class="line">    dto.setCompanyDescription(jobSearch.getCompanyDescription());</span><br><span class="line">    <span class="keyword">return</span> dto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>前端请求：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">handleExport</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 发送导出请求</span></span><br><span class="line">        <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&quot;http://localhost:5173/api/user-info/exportExcel&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">method</span>: <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (response.<span class="property">ok</span>) &#123;</span><br><span class="line">            <span class="comment">// 将响应转换为 Blob 对象</span></span><br><span class="line">            <span class="keyword">const</span> blob = <span class="keyword">await</span> response.<span class="title function_">blob</span>();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 创建下载链接</span></span><br><span class="line">            <span class="keyword">const</span> url = <span class="variable language_">window</span>.<span class="property">URL</span>.<span class="title function_">createObjectURL</span>(blob);</span><br><span class="line">            <span class="keyword">const</span> link = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">            link.<span class="property">href</span> = url;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 设置文件名，确保与后端导出一致</span></span><br><span class="line">            link.<span class="title function_">setAttribute</span>(<span class="string">&quot;download&quot;</span>, <span class="string">&quot;用户信息.xlsx&quot;</span>);</span><br><span class="line">            <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(link);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 自动触发下载</span></span><br><span class="line">            link.<span class="title function_">click</span>();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 清理临时链接</span></span><br><span class="line">            <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(link);</span><br><span class="line">            <span class="variable language_">window</span>.<span class="property">URL</span>.<span class="title function_">revokeObjectURL</span>(url);</span><br><span class="line"></span><br><span class="line">            <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(<span class="string">&quot;文件导出成功！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;文件导出失败，请重试！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;导出过程中出现错误：&quot;</span>, error);</span><br><span class="line">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;导出过程中出现错误！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="esayexcel标红错误部分数据的单元格"><a href="#esayexcel标红错误部分数据的单元格" class="headerlink" title="esayexcel标红错误部分数据的单元格"></a>esayexcel标红错误部分数据的单元格</h2><p>注意别忘了ExcelDto里加上<code>errorMessages</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ActivityTargetAudienceExcelDto</span> &#123;</span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;序号&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;年级&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String audienceLabel;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;班级&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String audienceValue;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;专业名称&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String major;</span><br><span class="line">  </span><br><span class="line">  	<span class="meta">@ExcelIgnore</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;Integer, String&gt; errorMessages = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>整体步骤</p>
<ol>
<li><strong>数据读取与校验</strong>：<ul>
<li>通过 <code>EasyExcel</code> 读取用户上传的 Excel 文件。</li>
<li>使用自定义监听器（<code>JobSearchExcelImportListener</code>）对每一行数据进行校验，记录错误信息。</li>
</ul>
</li>
<li><strong>标注错误单元格</strong>：<ul>
<li>如果检测到错误，通过自定义的 <code>ErrorCellStyleHandler</code> 在输出的 Excel 中将错误单元格标红，并在最后一列记录对应的错误信息。</li>
</ul>
</li>
<li><strong>导出错误文件</strong>：<ul>
<li>如果存在错误数据，将处理后的 Excel 数据（包含标注）作为错误文件导出。</li>
<li>如果没有错误，则将数据保存到数据库。</li>
</ul>
</li>
</ol>
<p>ErrorCellStyleHandler</p>
<p><strong>作用</strong>：</p>
<ul>
<li>对包含错误数据的单元格进行样式修改（标红）。</li>
<li>在最后一列追加错误描述。</li>
</ul>
<p><strong>关键逻辑</strong>：</p>
<ul>
<li><code>afterCellDispose</code>：<ul>
<li>检测当前单元格是否包含错误信息。</li>
<li>如果有错误，则设置背景色为红色。</li>
</ul>
</li>
<li><code>afterRowDispose</code>：<ul>
<li>如果是标题行，在最后一列添加“错误信息”标题。</li>
<li>如果是数据行，在最后一列写入当前行的错误描述。</li>
</ul>
</li>
</ul>
<p><strong>注意事项</strong>：</p>
<ul>
<li>样式设置时，确保未覆盖已有样式。</li>
<li>行索引与列索引从 0 开始，容易混淆。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ErrorCellStyleHandler</span> <span class="keyword">implements</span> <span class="title class_">CellWriteHandler</span>, RowWriteHandler &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> List&lt;Map&lt;Integer, String&gt;&gt; errorDataList;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ErrorCellStyleHandler</span><span class="params">(List&lt;Map&lt;Integer, String&gt;&gt; errorDataList)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.errorDataList = errorDataList;</span><br><span class="line">        System.out.println(<span class="string">&quot;ErrorCellStyleHandler initialized&quot;</span>+errorDataList.size());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCellDispose</span><span class="params">(CellWriteHandlerContext context)</span> &#123;</span><br><span class="line">        <span class="comment">// 检查是否是数据行（非表头）</span></span><br><span class="line">        <span class="keyword">if</span> (Boolean.TRUE.equals(context.getHead())) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取当前行索引和列索引</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">rowIndex</span> <span class="operator">=</span> context.getRowIndex();</span><br><span class="line">        <span class="type">int</span> <span class="variable">columnIndex</span> <span class="operator">=</span> context.getColumnIndex();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 检查当前单元格是否存在错误</span></span><br><span class="line">        <span class="keyword">if</span> (rowIndex &gt; <span class="number">0</span> &amp;&amp; rowIndex - <span class="number">1</span> &lt; errorDataList.size()) &#123; <span class="comment">// rowIndex 是从 1 开始的</span></span><br><span class="line">            Map&lt;Integer, String&gt; errorMap = errorDataList.get(rowIndex - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (errorMap.containsKey(columnIndex)) &#123;</span><br><span class="line">                <span class="comment">// 获取或创建样式</span></span><br><span class="line">                WriteCellData&lt;?&gt; cellData = context.getFirstCellData();</span><br><span class="line">                <span class="type">WriteCellStyle</span> <span class="variable">writeCellStyle</span> <span class="operator">=</span> cellData.getOrCreateStyle();</span><br><span class="line">                writeCellStyle.setFillPatternType(FillPatternType.SOLID_FOREGROUND);</span><br><span class="line">                writeCellStyle.setFillForegroundColor(IndexedColors.RED.getIndex());</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 输出日志，便于调试</span></span><br><span class="line">                System.out.println(<span class="string">&quot;标记错误: 行 &quot;</span> + (rowIndex + <span class="number">1</span>) + <span class="string">&quot;, 列 &quot;</span> + (columnIndex + <span class="number">1</span>) + <span class="string">&quot;, 错误信息: &quot;</span> + errorMap.get(columnIndex));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterRowDispose</span><span class="params">(RowWriteHandlerContext context)</span> &#123;</span><br><span class="line">        <span class="comment">// 如果是头部行，添加“错误信息”标题</span></span><br><span class="line">        <span class="keyword">if</span> (BooleanUtils.isTrue(context.getHead())) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">lastColumnIndex</span> <span class="operator">=</span> context.getRow().getLastCellNum();</span><br><span class="line">            <span class="type">Cell</span> <span class="variable">cell</span> <span class="operator">=</span> context.getRow().createCell(lastColumnIndex, CellType.STRING);</span><br><span class="line">            cell.setCellValue(<span class="string">&quot;错误信息&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="type">Workbook</span> <span class="variable">workbook</span> <span class="operator">=</span> context.getWriteWorkbookHolder().getWorkbook();</span><br><span class="line">            <span class="type">CellStyle</span> <span class="variable">headerStyle</span> <span class="operator">=</span> workbook.createCellStyle();</span><br><span class="line">            <span class="type">Font</span> <span class="variable">font</span> <span class="operator">=</span> workbook.createFont();</span><br><span class="line">            font.setBold(<span class="literal">true</span>);</span><br><span class="line">            headerStyle.setFont(font);</span><br><span class="line">            cell.setCellStyle(headerStyle);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果不是头部，处理错误信息列</span></span><br><span class="line">        <span class="keyword">if</span> (context.getRelativeRowIndex() != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">rowIndex</span> <span class="operator">=</span> context.getRelativeRowIndex();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (rowIndex &lt; errorDataList.size()) &#123;</span><br><span class="line">                Map&lt;Integer, String&gt; errorMap = errorDataList.get(rowIndex);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (errorMap != <span class="literal">null</span> &amp;&amp; !errorMap.isEmpty()) &#123;</span><br><span class="line">                    <span class="type">int</span> <span class="variable">lastColumnIndex</span> <span class="operator">=</span> context.getRow().getLastCellNum();</span><br><span class="line">                    <span class="type">String</span> <span class="variable">errorMessage</span> <span class="operator">=</span> String.join(<span class="string">&quot;; &quot;</span>, errorMap.values());</span><br><span class="line">                    <span class="type">Cell</span> <span class="variable">cell</span> <span class="operator">=</span> context.getRow().createCell(lastColumnIndex, CellType.STRING);</span><br><span class="line">                    cell.setCellValue(errorMessage);</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 设置样式（如红色字体）</span></span><br><span class="line">                    <span class="type">Workbook</span> <span class="variable">workbook</span> <span class="operator">=</span> context.getWriteWorkbookHolder().getWorkbook();</span><br><span class="line">                    <span class="type">CellStyle</span> <span class="variable">errorStyle</span> <span class="operator">=</span> workbook.createCellStyle();</span><br><span class="line">                    <span class="type">Font</span> <span class="variable">font</span> <span class="operator">=</span> workbook.createFont();</span><br><span class="line">                    font.setColor(IndexedColors.RED.getIndex());</span><br><span class="line">                    errorStyle.setFont(font);</span><br><span class="line">                    cell.setCellStyle(errorStyle);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>JobSearchExcellmportListener</p>
<p><strong>作用</strong>：</p>
<ul>
<li>负责监听 Excel 的数据解析过程。</li>
<li>对每一行的关键字段（如招聘企业、岗位、薪资等）进行校验，记录错误信息。</li>
</ul>
<p><strong>关键逻辑</strong>：</p>
<ul>
<li>利用 <code>Map&lt;Integer, String&gt;</code> 存储每一行错误信息，其中键为列索引，值为错误描述。</li>
<li><code>errorDataList</code> 保存所有行的错误信息，用于后续处理。</li>
</ul>
<p><strong>注意事项</strong>：</p>
<ul>
<li>检查逻辑需要与业务需求保持一致，例如字段是否为必填、格式是否正确等。</li>
<li>注意之前确保每行都有一个 Map部分的代码有误，现在是修正版本，否则只是储存了有错误的数据，实际上每行都要存入，即使该行没错误</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JobSearchExcelImportListener</span> <span class="keyword">extends</span> <span class="title class_">AnalysisEventListener</span>&lt;JobSearchExcelDto&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> List&lt;JobSearchExcelDto&gt; jobList;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> List&lt;Map&lt;Integer, String&gt;&gt; errorDataList;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">JobSearchExcelImportListener</span><span class="params">(List&lt;JobSearchExcelDto&gt; jobList, List&lt;Map&lt;Integer, String&gt;&gt; errorDataList)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.jobList = jobList;</span><br><span class="line">        <span class="built_in">this</span>.errorDataList = errorDataList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">invoke</span><span class="params">(JobSearchExcelDto dto, AnalysisContext context)</span> &#123;</span><br><span class="line">        Map&lt;Integer, String&gt; errors = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 校验第 3 列: 招聘企业</span></span><br><span class="line">        <span class="keyword">if</span> (dto.getCompanyName() == <span class="literal">null</span> || dto.getCompanyName().isEmpty()) &#123;</span><br><span class="line">            errors.put(<span class="number">2</span>, <span class="string">&quot;招聘企业不能为空&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 校验第 4 列: 招聘岗位</span></span><br><span class="line">        <span class="keyword">if</span> (dto.getPositionName() == <span class="literal">null</span> || dto.getPositionName().isEmpty()) &#123;</span><br><span class="line">            errors.put(<span class="number">3</span>, <span class="string">&quot;招聘岗位不能为空&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 校验第 7 列: 所需专业</span></span><br><span class="line">        <span class="keyword">if</span> (dto.getMajorRequirement() == <span class="literal">null</span> || dto.getMajorRequirement().isEmpty()) &#123;</span><br><span class="line">            errors.put(<span class="number">6</span>, <span class="string">&quot;所需专业不能为空&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!Pattern.matches(<span class="string">&quot;^[\\w/\\u4e00-\\u9fa5]+$&quot;</span>, dto.getMajorRequirement())) &#123;</span><br><span class="line">            errors.put(<span class="number">6</span>, <span class="string">&quot;所需专业必须使用“/”分割&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 校验第 8 列: 招聘人数</span></span><br><span class="line">        <span class="keyword">if</span> (dto.getParticipantCount() == <span class="literal">null</span>) &#123;</span><br><span class="line">            errors.put(<span class="number">7</span>, <span class="string">&quot;招聘人数不能为空&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 校验第 9 列: 薪资待遇</span></span><br><span class="line">        <span class="keyword">if</span> (dto.getMoney() == <span class="literal">null</span> || dto.getMoney().isEmpty()) &#123;</span><br><span class="line">            errors.put(<span class="number">8</span>, <span class="string">&quot;薪资待遇不能为空&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            List&lt;String&gt; validSalaries = Arrays.asList(<span class="string">&quot;2000-5000&quot;</span>, <span class="string">&quot;5000-8000&quot;</span>, <span class="string">&quot;8000-15000&quot;</span>, <span class="string">&quot;15000以上&quot;</span>,<span class="string">&quot;面议&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (!validSalaries.contains(dto.getMoney())) &#123;</span><br><span class="line">                errors.put(<span class="number">8</span>, <span class="string">&quot;薪资待遇格式错误，仅支持以下格式: 2000-5000, 5000-8000, 8000-15000, 15000以上, 面议&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 校验第 10 列: 地区</span></span><br><span class="line">        <span class="keyword">if</span> (dto.getArea() == <span class="literal">null</span> || dto.getArea().isEmpty()) &#123;</span><br><span class="line">            errors.put(<span class="number">9</span>, <span class="string">&quot;地区不能为空&quot;</span>);</span><br><span class="line">        &#125;  <span class="keyword">else</span> <span class="keyword">if</span> (!Pattern.matches(<span class="string">&quot;^[\\w,\\u4e00-\\u9fa5]+$&quot;</span>, dto.getArea())) &#123;</span><br><span class="line">            errors.put(<span class="number">9</span>, <span class="string">&quot;地区必须使用英文逗号分割&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 保存错误信息到 dto</span></span><br><span class="line">        dto.setErrorMessages(errors);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将 dto 和错误信息添加到列表</span></span><br><span class="line">        jobList.add(dto);</span><br><span class="line">        errorDataList.add(errors.isEmpty() ? <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;() : errors);  <span class="comment">// 确保每行都有一个 Map</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doAfterAllAnalysed</span><span class="params">(AnalysisContext context)</span> &#123;</span><br><span class="line">        <span class="comment">// 全部解析完成后的处理</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>JobSearchController</p>
<p><strong>作用</strong>：</p>
<ul>
<li>读取用户上传的文件，并根据错误情况决定后续操作：<ol>
<li>如果没有错误，直接保存数据。</li>
<li>如果有错误，生成包含错误标注的文件并返回给用户。</li>
</ol>
</li>
</ul>
<p><strong>关键逻辑</strong>：</p>
<ul>
<li>判断是否存在错误：<code>jobList.stream().anyMatch(...)</code>。</li>
<li>使用 <code>EasyExcel</code> 写入时，注册 <code>ErrorCellStyleHandler</code> 以实现错误标注。</li>
</ul>
<p><strong>注意事项</strong>：</p>
<ul>
<li>返回 Excel 文件时需要正确设置 <code>Content-Type</code> 和 <code>Content-Disposition</code>。</li>
<li>处理异常时需要保证响应的输出流关闭。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/importExcel&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">importJobSearchExcel</span><span class="params">(<span class="meta">@RequestParam(&quot;file&quot;)</span> MultipartFile file, HttpServletResponse response)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 存储读取的数据和错误信息</span></span><br><span class="line">            List&lt;JobSearchExcelDto&gt; jobList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            List&lt;Map&lt;Integer, String&gt;&gt; errorDataList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 创建 ExcelImportListener</span></span><br><span class="line">            <span class="type">JobSearchExcelImportListener</span> <span class="variable">listener</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JobSearchExcelImportListener</span>(jobList, errorDataList);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 使用 EasyExcel 读取 Excel 数据，使用自定义监听器</span></span><br><span class="line">            EasyExcel.read(file.getInputStream(), JobSearchExcelDto.class, listener)</span><br><span class="line">                    .sheet()</span><br><span class="line">                    .doReadSync();  <span class="comment">// 使用同步读取方式，确保读取所有行</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果没有数据，则返回提示</span></span><br><span class="line">            <span class="keyword">if</span> (jobList.isEmpty()) &#123;</span><br><span class="line">                response.setContentType(<span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">                response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">                response.getWriter().write(<span class="string">&quot;&#123;\&quot;message\&quot;:\&quot;导入数据为空\&quot;&#125;&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 检查是否存在错误</span></span><br><span class="line">            <span class="type">boolean</span> <span class="variable">hasErrors</span> <span class="operator">=</span> jobList.stream()</span><br><span class="line">                    .anyMatch(dto -&gt; dto.getErrorMessages() != <span class="literal">null</span> &amp;&amp; !dto.getErrorMessages().isEmpty());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (hasErrors) &#123;</span><br><span class="line">                <span class="comment">// 如果有错误，生成错误文件并返回</span></span><br><span class="line">                response.setContentType(<span class="string">&quot;application/vnd.ms-excel&quot;</span>);</span><br><span class="line">                response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">                response.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment;filename=error_data.xlsx&quot;</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 调用 EasyExcel 写入错误数据</span></span><br><span class="line">                EasyExcel.write(response.getOutputStream(), JobSearchExcelDto.class)</span><br><span class="line">                        .registerWriteHandler(<span class="keyword">new</span> <span class="title class_">ErrorCellStyleHandler</span>(errorDataList))</span><br><span class="line">                        .sheet(<span class="string">&quot;错误数据&quot;</span>)</span><br><span class="line">                        .doWrite(jobList);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 使用 mapToJobSearch 将 DTO 转换为实体列表</span></span><br><span class="line">            List&lt;JobSearch&gt; jobEntities = jobList.stream()</span><br><span class="line">                    .map(<span class="built_in">this</span>::mapToJobSearch)  <span class="comment">// 调用 mapToJobSearch 方法</span></span><br><span class="line">                    .collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 批量保存或更新</span></span><br><span class="line">            <span class="keyword">if</span> (!jobEntities.isEmpty()) &#123;</span><br><span class="line">                jobSearchService.saveOrUpdateBatch(jobEntities);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 返回成功信息</span></span><br><span class="line">            response.setContentType(<span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">            response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">            response.getWriter().write(<span class="string">&quot;&#123;\&quot;message\&quot;:\&quot;导入成功\&quot;&#125;&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                response.setContentType(<span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">                response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">                response.getWriter().write(<span class="string">&quot;&#123;\&quot;message\&quot;:\&quot;导入失败: &quot;</span> + e.getMessage() + <span class="string">&quot;\&quot;&#125;&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException ioException) &#123;</span><br><span class="line">                ioException.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>CustomlntegerConverter</p>
<p><strong>自定义类型转换：<code>CustomIntegerConverter</code></strong></p>
<ul>
<li>作用：<ul>
<li>解决 Excel 数据中整数字段可能为空、格式错误的问题。</li>
<li>在读取或写入过程中，将错误数据转换为默认值（如 0），但保留错误信息。</li>
</ul>
</li>
<li>关键逻辑：<ul>
<li>**<code>convertToJavaData</code>**：解析单元格数据，确保其为合法的整数格式，否则返回默认值。</li>
<li>**<code>convertToExcelData</code>**：在写入 Excel 时，优先输出原始错误数据。</li>
</ul>
</li>
<li>注意事项：<ul>
<li>注意字符串转换为数字时可能抛出的 <code>NumberFormatException</code>。</li>
<li>确保 <code>errorData</code> 在多线程情况下不会被共享导致数据错误。</li>
<li>原始错误信息保留这块通过解析单元格数据时存入，在写入 Excel 时通过变量改变实现的，否则是无法存入不同类型的数据的</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomIntegerConverter</span> <span class="keyword">implements</span> <span class="title class_">Converter</span>&lt;Integer&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">errorData</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">convertToJavaData</span><span class="params">(ReadCellData cellData, ExcelContentProperty contentProperty, GlobalConfiguration globalConfiguration)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">cellValue</span> <span class="operator">=</span> cellData.getStringValue();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果是 null 或者空字符串，尝试读取为数字</span></span><br><span class="line">        <span class="keyword">if</span> (cellValue == <span class="literal">null</span> || cellValue.trim().isEmpty()) &#123;</span><br><span class="line">            <span class="comment">// 尝试使用数字格式获取值</span></span><br><span class="line">            <span class="keyword">if</span> (cellData.getNumberValue() != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> cellData.getNumberValue().intValue();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;  <span class="comment">// 错误格式时返回 0</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 尝试将表格中的字符串转换为 Integer</span></span><br><span class="line">            <span class="keyword">return</span> Integer.parseInt(cellValue);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NumberFormatException e) &#123;</span><br><span class="line">            <span class="comment">// 如果字符串不能转换为整数，返回 0</span></span><br><span class="line">            errorData = cellValue;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;  <span class="comment">// 错误格式时返回 0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> WriteCellData&lt;?&gt; convertToExcelData(Integer value, ExcelContentProperty contentProperty, GlobalConfiguration globalConfiguration) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;convertToExcelData-errorData: &quot;</span> + errorData);</span><br><span class="line">        <span class="comment">// 如果值为 null 或 0，则写入空字符串，避免写入错误数据</span></span><br><span class="line">        <span class="keyword">if</span> (value == <span class="literal">null</span> || value == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">WriteCellData</span>&lt;&gt;(errorData); <span class="comment">// 返回空字符串</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 正常转换 Integer 为字符串</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">WriteCellData</span>&lt;&gt;(String.valueOf(value));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<p>学生信息表备份：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;h-full&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;div class=&quot;flex justify-center items-center px-8&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;h-full&quot;&gt;</span><br><span class="line">                &lt;p class=&quot;md:text-4xl font-extrabold text-2xl&quot; v-if=&quot;userInfo.user?.userType == &#x27;student&#x27;&quot;&gt;个人信息登记详情&lt;/p&gt;</span><br><span class="line">                &lt;p class=&quot;md:text-4xl font-extrabold text-2xl text-center&quot; v-if=&quot;userInfo.user?.userType == &#x27;teacher&#x27;&quot;&gt;&#123;&#123; userDetail.name &#125;&#125;学生信息表&lt;/p&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;el-scrollbar height=&quot;90%&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;main flex flex-col justify-center gap-10 p-10&quot;&gt;</span><br><span class="line">                &lt;!-- 第一行 --&gt;</span><br><span class="line">                &lt;div class=&quot;flex flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;学生照片：&lt;/p&gt;</span><br><span class="line">                        &lt;img :src=&quot;userDetail.imageUrl&quot; class=&quot;avatar&quot; /&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;姓名：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.name &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;性别：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.gender &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">                &lt;!-- 第二行 --&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;手机号：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.phone &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;学号：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.studentId &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center mt-4 md:mt-0&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;身份证号：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.idCard &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">                &lt;!-- 第三行 --&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;年级：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.grade &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center mt-4 md:mt-0&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;专业：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.major &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;班级：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.className &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">                &lt;!-- 出生日期相关 --&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;出生日期：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.birthDate &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;入学日期：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.admissionDate &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;预计毕业时间：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.expectedGraduation &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">                &lt;!-- 其他信息 --&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;籍贯：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.nativePlace &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;生源地：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.sourcePlace &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;民族：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.ethnicity &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &lt;!-- 第四行 --&gt;</span><br><span class="line">                &lt;div class=&quot;flex flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;班级职务：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.classRole &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;专业方向：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.specialization &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;户口所在地：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.residence &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;家庭住址：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.homeAddress &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;辅导员：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.counselor &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;辅导员手机号：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.counselorPhone &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;班主任：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.classTeacher &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;班主任手机号：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.classTeacherPhone &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;毕设导师：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.graduationTutor &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;毕设导师手机号：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.graduationTutorPhone &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;寝室号：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.dormitoryNumber &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;红旗网络：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.networkStatus &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;寝室成员名单：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.dormitoryMembers &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;政治面貌：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.politicalStatus &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;入党进度：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.partyProgress &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;入党培训进度：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.partyTrainingProgress &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;所在支部：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.branchName &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;入党申请时间：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.applicationDate &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;入党积极分子时间：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.activistDate &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;发展对象时间：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.developmentDate &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;预备党员时间：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.probationaryDate &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;发展转正时间：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.fullMemberDate &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;党建工时：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.partyHours &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;党支部书记姓名：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.branchSecretary &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;党支部副书记姓名：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.branchDeputySecretary &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;电子邮箱：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.email &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;QQ号码：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.qqNumber &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;微信号码：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.wechatId &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;抖音账号：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.douyinId &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;!-- 家长1信息 --&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;家长1姓名：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.parent1Name &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;家长1手机号：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.parent1Phone &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;家长1工作单位：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.parent1Company &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;家长1职业：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.parent1Job &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;!-- 家长2信息 --&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;家长2姓名：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.parent2Name &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;家长2手机号：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.parent2Phone &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;家长2工作单位：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.parent2Company &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;家长2职业：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.parent2Job &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;md:flex md:flex-1 justify-between items-center gap-10&quot;&gt;</span><br><span class="line">                    &lt;!-- 紧急联系人信息 --&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;紧急联系人姓名：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.emergencyContactName &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;flex flex-1 justify-start items-center&quot;&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;紧急联系人手机号：&lt;/p&gt;</span><br><span class="line">                        &lt;p class=&quot;text-xl font-bold whitespace-nowrap&quot;&gt;&#123;&#123; userDetail.emergencyContactPhone &#125;&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/el-scrollbar&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref, onMounted &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; Delete, Download, Plus, ZoomIn &#125; from &#x27;@element-plus/icons-vue&#x27;;</span><br><span class="line">import router from &#x27;../router/index&#x27;;</span><br><span class="line">import &#123; useRoute &#125; from &#x27;vue-router&#x27;;</span><br><span class="line">import &#123; ElMessage &#125; from &#x27;element-plus&#x27;;</span><br><span class="line">import &#123; pcaTextArr &#125; from &quot;element-china-area-data&quot;;</span><br><span class="line">import type &#123; UploadProps &#125; from &#x27;element-plus&#x27;</span><br><span class="line"></span><br><span class="line">// 引入接口方法</span><br><span class="line">import &#123; addUserInfo, getUserInfoById, editUserInfo &#125; from &#x27;../api/userInfo&#x27;;</span><br><span class="line">import type &#123; UploadFile &#125; from &#x27;element-plus&#x27;;</span><br><span class="line">import &#123; userInfoStore &#125; from &quot;../stores/UserInfoStore&quot;;</span><br><span class="line">const userInfo = userInfoStore();</span><br><span class="line"></span><br><span class="line">// 是否为修改模式</span><br><span class="line">const route = useRoute();</span><br><span class="line">const isEdit = ref(false);</span><br><span class="line">const loading = ref(false);</span><br><span class="line"></span><br><span class="line">// 定义表单字段</span><br><span class="line">const id = ref(&#x27;&#x27;);</span><br><span class="line">const name = ref(&#x27;&#x27;);</span><br><span class="line">const gender = ref&lt;&#x27;男&#x27; | &#x27;女&#x27;&gt;(&#x27;男&#x27;);</span><br><span class="line">const className = ref(&#x27;&#x27;);</span><br><span class="line">const studentId = ref(&#x27;&#x27;);</span><br><span class="line">const contactNumber = ref(&#x27;&#x27;);</span><br><span class="line">const classTeacher = ref(&#x27;&#x27;);</span><br><span class="line">const graduationTutor = ref(&#x27;&#x27;);</span><br><span class="line">const futurePlan = ref(&#x27;&#x27;);</span><br><span class="line">const salary = ref(&#x27;&#x27;);</span><br><span class="line">const companyNature = ref(&#x27;&#x27;);</span><br><span class="line">const workLocation = ref([]);</span><br><span class="line">const employmentStatus = ref(&#x27;实习&#x27;);</span><br><span class="line">const companyName = ref(&#x27;&#x27;);</span><br><span class="line"></span><br><span class="line">const userDetail = ref&lt;any&gt;(&#123;</span><br><span class="line">    id: &#x27;&#x27;, // 用户ID</span><br><span class="line">    name: &#x27;&#x27;, // 姓名</span><br><span class="line">    gender: &#x27;男&#x27;, // 性别</span><br><span class="line">    studentId: &#x27;&#x27;, // 学号</span><br><span class="line">    idCard: &#x27;&#x27;, // 身份证号</span><br><span class="line">    grade: &#x27;&#x27;, // 年级</span><br><span class="line">    major: &#x27;&#x27;, // 专业</span><br><span class="line">    className: &#x27;&#x27;, // 班级</span><br><span class="line">    classRole: &#x27;&#x27;, // 班级职务</span><br><span class="line">    specialization: &#x27;&#x27;, // 专业方向</span><br><span class="line">    birthDate: &#x27;&#x27;, // 出生日期</span><br><span class="line">    admissionDate: &#x27;&#x27;, // 入学日期</span><br><span class="line">    expectedGraduation: &#x27;&#x27;, // 预计毕业时间</span><br><span class="line">    nativePlace: &#x27;&#x27;, // 籍贯</span><br><span class="line">    sourcePlace: &#x27;&#x27;, // 生源地</span><br><span class="line">    ethnicity: &#x27;&#x27;, // 民族</span><br><span class="line">    residence: &#x27;&#x27;, // 户口所在地</span><br><span class="line">    homeAddress: &#x27;&#x27;, // 家庭住址</span><br><span class="line">    counselor: &#x27;&#x27;, // 辅导员姓名</span><br><span class="line">    counselorPhone: &#x27;&#x27;, // 辅导员手机号</span><br><span class="line">    classTeacher: &#x27;&#x27;, // 班主任姓名</span><br><span class="line">    classTeacherPhone: &#x27;&#x27;, // 班主任手机号</span><br><span class="line">    graduationTutor: &#x27;&#x27;, // 毕设导师姓名</span><br><span class="line">    graduationTutorPhone: &#x27;&#x27;, // 毕设导师手机号</span><br><span class="line">    dormitoryNumber: &#x27;&#x27;, // 寝室号</span><br><span class="line">    networkStatus: &#x27;&#x27;, // 红旗网络</span><br><span class="line">    dormitoryMembers: &#x27;&#x27;, // 寝室成员名单</span><br><span class="line">    politicalStatus: &#x27;&#x27;, // 政治面貌</span><br><span class="line">    partyProgress: &#x27;&#x27;, // 入党进度</span><br><span class="line">    partyTrainingProgress: &#x27;&#x27;, // 入党培训进度</span><br><span class="line">    branchName: &#x27;&#x27;, // 所在支部</span><br><span class="line">    applicationDate: &#x27;&#x27;, // 入党申请时间</span><br><span class="line">    activistDate: &#x27;&#x27;, // 入党积极分子时间</span><br><span class="line">    developmentDate: &#x27;&#x27;, // 发展对象时间</span><br><span class="line">    probationaryDate: &#x27;&#x27;, // 预备党员时间</span><br><span class="line">    fullMemberDate: &#x27;&#x27;, // 发展转正时间</span><br><span class="line">    partyHours: &#x27;&#x27;, // 党建工时</span><br><span class="line">    branchSecretary: &#x27;&#x27;, // 党支部书记姓名</span><br><span class="line">    branchDeputySecretary: &#x27;&#x27;, // 党支部副书记姓名</span><br><span class="line">    email: &#x27;&#x27;,</span><br><span class="line">    qqNumber: &#x27;&#x27;,</span><br><span class="line">    wechatId: &#x27;&#x27;,</span><br><span class="line">    douyinId: &#x27;&#x27;,</span><br><span class="line">    parent1Name: &#x27;&#x27;,</span><br><span class="line">    parent1Phone: &#x27;&#x27;,</span><br><span class="line">    parent1Company: &#x27;&#x27;,</span><br><span class="line">    parent1Job: &#x27;&#x27;,</span><br><span class="line">    parent2Name: &#x27;&#x27;,</span><br><span class="line">    parent2Phone: &#x27;&#x27;,</span><br><span class="line">    parent2Company: &#x27;&#x27;,</span><br><span class="line">    parent2Job: &#x27;&#x27;,</span><br><span class="line">    emergencyContactName: &#x27;&#x27;,</span><br><span class="line">    emergencyContactPhone: &#x27;&#x27;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 定义上传文件列表</span><br><span class="line">const fileList = ref&lt;UploadFile[]&gt;([]);</span><br><span class="line"></span><br><span class="line">// 初始化</span><br><span class="line">onMounted(async () =&gt; &#123;</span><br><span class="line">    await getUserInfoById(route.params.id as string).then((res) =&gt; &#123;</span><br><span class="line">        const data = res.data;</span><br><span class="line">        console.log(&quot;userDetail.value&quot;, userDetail.value);</span><br><span class="line">        // 如果不为空则填充表单字段,如果为空则重置表单字段</span><br><span class="line">        if (data) &#123;</span><br><span class="line">            populateFormFields(data);</span><br><span class="line">            isEdit.value = true;</span><br><span class="line">            loading.value = true;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            isEdit.value = false;</span><br><span class="line">            resetFormFields();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        loading.value = false;</span><br><span class="line">    &#125;).catch((err) =&gt; &#123;</span><br><span class="line">        console.log(err);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 重置表单字段</span><br><span class="line">const resetFormFields = () =&gt; &#123;</span><br><span class="line">    name.value = &#x27;&#x27;;</span><br><span class="line">    gender.value = &#x27;男&#x27;;</span><br><span class="line">    className.value = &#x27;&#x27;;</span><br><span class="line">    studentId.value = &#x27;&#x27;;</span><br><span class="line">    contactNumber.value = &#x27;&#x27;;</span><br><span class="line">    classTeacher.value = &#x27;&#x27;;</span><br><span class="line">    graduationTutor.value = &#x27;&#x27;;</span><br><span class="line">    futurePlan.value = &#x27;&#x27;;</span><br><span class="line">    salary.value = &#x27;&#x27;;</span><br><span class="line">    companyNature.value = &#x27;&#x27;;</span><br><span class="line">    workLocation.value = [];</span><br><span class="line">    employmentStatus.value = &#x27;实习&#x27;;</span><br><span class="line">    companyName.value = &#x27;&#x27;;</span><br><span class="line">    fileList.value = [];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const populateFormFields = (data: any) =&gt; &#123;</span><br><span class="line">    Object.assign(userDetail.value, data);</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.fade-enter-active,</span><br><span class="line">.fade-leave-active &#123;</span><br><span class="line">    transition: opacity 0.3s ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.fade-enter-from,</span><br><span class="line">.fade-leave-to &#123;</span><br><span class="line">    opacity: 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 下面为el-select部分</span><br><span class="line">@mixin select_radius &#123;</span><br><span class="line">    border-radius: 12px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 控制el-select的长度以及圆角</span><br><span class="line">:deep(.el-select__wrapper) &#123;</span><br><span class="line">    height: 50px;</span><br><span class="line">    @include select_radius;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 控制el-select中文字的样式</span><br><span class="line">:deep(.el-select__placeholder) &#123;</span><br><span class="line"></span><br><span class="line">    font-size: 16px;</span><br><span class="line">    font-weight: bold;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 控制点击后的边框颜色</span><br><span class="line">:deep(.el-select__wrapper.is-focused) &#123;</span><br><span class="line">    box-shadow: 0 0 0 1px var(--accent-100);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 下面为下拉框部分</span><br><span class="line">// 下面用于控制整体的下拉框圆角</span><br><span class="line">:deep(.el-select__popper.el-popper) &#123;</span><br><span class="line">    @include select_radius;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//下拉框的文本未选中的样式</span><br><span class="line">// .el-select-dropdown__item &#123;</span><br><span class="line"></span><br><span class="line">// &#125;</span><br><span class="line">//下拉框的文本颜色选中之后的样式</span><br><span class="line">.el-select-dropdown__item.is-selected &#123;</span><br><span class="line">    color: var(--accent-200);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.el-input &#123;</span><br><span class="line">    height: 50px;</span><br><span class="line"></span><br><span class="line">    border-radius: 12px;</span><br><span class="line">    border: 0.5px solid var(--text-200);</span><br><span class="line">    border: 0;</span><br><span class="line">    background-color: var(--bg-200);</span><br><span class="line"></span><br><span class="line">    font-size: 16px;</span><br><span class="line">    font-weight: bold;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    :deep(.el-input__wrapper) &#123;</span><br><span class="line">        border-radius: 12px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    :deep(.is-focus) &#123;</span><br><span class="line">        box-shadow: 0 0 0 1px var(--accent-100)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 下面是日期选择组件的自定义样式</span><br><span class="line">:deep(.el-date-editor.el-input, .el-date-editor.el-input__wrapper) &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 50px;</span><br><span class="line">    border-radius: 12px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.el-date-editor-style &#123;</span><br><span class="line">    --el-input-border-radius: 12px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 下面是数字选择组件的自定义样式</span><br><span class="line">.el-input-number &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 50px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">:deep(.el-input) &#123;</span><br><span class="line">    box-shadow: 0 0 0 1px var(--accent-200, var(--accent-100)) inset;</span><br><span class="line">    border-radius: 12px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">:deep(.el-input-number__increase:hover~.el-input:not(.is-disabled) .el-input__wrapper) &#123;</span><br><span class="line">    box-shadow: 0 0 0 1px var(--accent-200, var(--accent-100)) inset;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">:deep(.el-input-number__decrease:hover~.el-input:not(.is-disabled) .el-input__wrapper) &#123;</span><br><span class="line">    box-shadow: 0 0 0 1px var(--accent-200, var(--accent-100)) inset;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">:deep(.el-input-number__increase:hover) &#123;</span><br><span class="line">    color: var(--accent-200);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">:deep(.el-input-number__decrease:hover) &#123;</span><br><span class="line">    color: var(--accent-200);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">:deep(.el-input__wrapper.is-focus) &#123;</span><br><span class="line">    box-shadow: 0 0 0 1px var(--accent-200, var(--accent-100)) inset !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 下面是textarea组件的自定义样式</span><br><span class="line">.el-textarea &#123;</span><br><span class="line">    font-size: 16px;</span><br><span class="line">    font-weight: bold;</span><br><span class="line"></span><br><span class="line">    --el-input-focus-border-color: var(--accent-200);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 下面是地区选择组件的自定义样式</span><br><span class="line">:deep(.el-cascader--large) &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 50px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">:deep(.el-cascader .el-input) &#123;</span><br><span class="line">    height: 50px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">:deep(.el-input--large .el-input__wrapper) &#123;</span><br><span class="line">    border-radius: 12px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">:deep(.el-cascader .el-input .el-input__inner) &#123;</span><br><span class="line">    font-size: 16px;</span><br><span class="line">    font-weight: bold;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.avatar-uploader .avatar &#123;</span><br><span class="line">    width: 80px;</span><br><span class="line">    height: 112px;</span><br><span class="line">    /* 80px * (35/25) */</span><br><span class="line">    display: block;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">.avatar-uploader .el-upload &#123;</span><br><span class="line">    border: 1px dashed var(--el-border-color);</span><br><span class="line">    border-radius: 6px;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    position: relative;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    transition: var(--el-transition-duration-fast);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.avatar-uploader .el-upload:hover &#123;</span><br><span class="line">    border-color: var(--el-color-primary);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.el-icon.avatar-uploader-icon &#123;</span><br><span class="line">    font-size: 28px;</span><br><span class="line">    color: #8c939d;</span><br><span class="line">    width: 80px;</span><br><span class="line">    height: 112px;</span><br><span class="line">    /* 80px * (35/25) */</span><br><span class="line">    text-align: center;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>



<h1 id="Vue3-打印实现"><a href="#Vue3-打印实现" class="headerlink" title="Vue3 打印实现"></a>Vue3 打印实现</h1><p><strong>Vue3 中使用 html2canvas + jspdf + print-js 实现打印的详细方案</strong></p>
<p>这套方案适合复杂页面的打印需求，尤其是在需要高精度 PDF 输出、支持跨域图片加载以及良好页面布局控制的情况下。</p>
<p><strong>核心功能简介</strong></p>
<p>​	1.	html2canvas：</p>
<p>​	•	将指定的 DOM 元素渲染为 canvas 图像。</p>
<p>​	•	支持动态内容（如样式、图片）。</p>
<p>​	•	配合 useCORS 参数解决图片跨域问题。</p>
<p>​	2.	jspdf：</p>
<p>​	•	将 canvas 转换为 PDF 文件。</p>
<p>​	•	支持多页 PDF 输出。</p>
<p>​	3.	print-js：</p>
<p>​	•	支持直接打印 HTML 或 PDF 文件。</p>
<p>​	•	提供弹窗式的打印预览，体验更友好。</p>
<p><strong>实现步骤</strong></p>
<p><strong>1. 安装依赖</strong></p>
<p>运行以下命令安装相关库：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install html2canvas jspdf print-js</span><br></pre></td></tr></table></figure>

<p><strong>2. 代码实现</strong></p>
<p><strong>(1) 基础模板代码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">  &lt;!-- 打印区域 --&gt;</span><br><span class="line">    &lt;div id=&quot;printArea&quot; class=&quot;p-5 bg-white&quot;&gt;</span><br><span class="line">   &lt;h1 class=&quot;text-xl font-bold&quot;&gt;学生信息表&lt;/h1&gt;</span><br><span class="line">      &lt;div class=&quot;flex items-center gap-4&quot;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;p&gt;姓名: &#123;&#123; userDetail.name &#125;&#125;&lt;/p&gt;</span><br><span class="line">          &lt;p&gt;学号: &#123;&#123; userDetail.studentId &#125;&#125;&lt;/p&gt;</span><br><span class="line">          &lt;p&gt;专业: &#123;&#123; userDetail.major &#125;&#125;&lt;/p&gt;</span><br><span class="line">​    &lt;/div&gt;</span><br><span class="line">​        &lt;img :src=&quot;userDetail.imageUrl&quot; class=&quot;w-32 h-32 border&quot; /&gt;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 按钮操作 --&gt;</span><br><span class="line">    &lt;div class=&quot;mt-5&quot;&gt;</span><br><span class="line">   &lt;button @click=&quot;exportToPDF&quot; class=&quot;px-4 py-2 bg-blue-500 text-white rounded&quot;&gt;导出 PDF&lt;/button&gt;</span><br><span class="line">   &lt;button @click=&quot;printPDF&quot; class=&quot;px-4 py-2 bg-green-500 text-white rounded&quot;&gt;打印&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"> &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">import html2canvas from &#x27;html2canvas&#x27;;</span><br><span class="line">import jsPDF from &#x27;jspdf&#x27;;</span><br><span class="line">import printJS from &#x27;print-js&#x27;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 导出为 PDF 并打印</span><br><span class="line">const handleExportToPDF = async () =&gt; &#123;</span><br><span class="line">    const element = document.getElementById(&#x27;printArea&#x27;);</span><br><span class="line">    if (!element) &#123;</span><br><span class="line">        console.error(&#x27;打印区域未找到&#x27;);</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">        // 将 DOM 转为图片</span><br><span class="line">        const canvas = await html2canvas(element, &#123;</span><br><span class="line">            scale: 2,</span><br><span class="line">            useCORS: true, // 启用跨域支持</span><br><span class="line">        &#125;);</span><br><span class="line">        const imgData = canvas.toDataURL(&#x27;image/jpeg&#x27;, 1.0);</span><br><span class="line"></span><br><span class="line">        // 创建 PDF</span><br><span class="line">        const pdf = new jsPDF(&#x27;p&#x27;, &#x27;mm&#x27;, &#x27;a4&#x27;);</span><br><span class="line">        const pdfWidth = pdf.internal.pageSize.getWidth();</span><br><span class="line">        const pdfHeight = (canvas.height * pdfWidth) / canvas.width;</span><br><span class="line">        pdf.addImage(imgData, &#x27;JPEG&#x27;, 0, 0, pdfWidth, pdfHeight);</span><br><span class="line"></span><br><span class="line">        // 导出 PDF 文件 Blob URL</span><br><span class="line">        const pdfBlob = pdf.output(&#x27;blob&#x27;);</span><br><span class="line">        const pdfUrl = URL.createObjectURL(pdfBlob);</span><br><span class="line"></span><br><span class="line">        // 使用 print-js 打印 PDF</span><br><span class="line">        printJS(&#123; printable: pdfUrl, type: &#x27;pdf&#x27;, showModal: true &#125;);</span><br><span class="line">    &#125; catch (error) &#123;</span><br><span class="line">        console.error(&#x27;生成 PDF 失败:&#x27;, error);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><strong>常见问题与解决方法</strong></p>
<p><strong>1. 图片跨域问题</strong></p>
<p>​	•	原因：html2canvas 对跨域资源有限制。</p>
<p>​	•	解决方案：</p>
<p>​	1.	使用 useCORS: true 参数。</p>
<p>​	2.	确保图片服务器启用了 CORS 并设置 Access-Control-Allow-Origin: *。</p>
<p><strong>2. 样式丢失</strong></p>
<p>​	•	原因：部分样式未被内联，或者浏览器限制外部样式加载。</p>
<p>​	•	解决方案：</p>
<p>​	•	不要直接使用printjs打印，而是转成pdf再打印</p>
<p><strong>最终建议</strong></p>
<p>​	•	<strong>简单需求</strong>：直接使用 print-js 打印。</p>
<p>​	•	<strong>复杂需求</strong>：结合 html2canvas + jspdf 输出 PDF，再通过 print-js 打印，适配性更强。</p>
<p>​	•	<strong>样式控制</strong>：确保打印专用样式定义清晰，避免内容超出页面或影响用户体验。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://tecnb.github.io">TEC</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://tecnb.github.io/posts/87103406.html">https://tecnb.github.io/posts/87103406.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://tecnb.github.io" target="_blank">TEC</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/TECNB/picgodemo@main/img/wallhaven-3l65w9_2560x1440.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/83a155e2.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/TECNB/picgodemo@main/img/wallhaven-9mjoy1_2560x1440.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Express学习</div></div></a></div><div class="next-post pull-right"><a href="/posts/1cb512bf.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/TECNB/picgodemo@main/img/Golang%E5%AD%A6%E4%B9%A0-cover.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Golang学习</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="lv-container" data-id="city" data-uid="MTAyMC81NzY3OC8zNDE0MQ=="></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#element-plus%E5%9C%B0%E7%82%B9%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-number">1.</span> <span class="toc-text">element plus地点选择器</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MP-%E5%88%86%E9%A1%B5%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.</span> <span class="toc-text">MP 分页实现</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%97%A5%E5%8E%86%E5%AE%9E%E7%8E%B0"><span class="toc-number">3.</span> <span class="toc-text">日历实现</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E4%B8%8D%E6%98%BE%E7%A4%BA"><span class="toc-number">3.1.</span> <span class="toc-text">日期不显示</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#el-popover%E4%BD%8D%E7%BD%AE%E9%94%99%E4%BD%8D%E9%97%AE%E9%A2%98"><span class="toc-number">3.2.</span> <span class="toc-text">el-popover位置错位问题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87"><span class="toc-number">4.</span> <span class="toc-text">上传获取图片</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E8%81%94%E8%A1%A8"><span class="toc-number">4.1.</span> <span class="toc-text">关联表</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E5%B9%B6%E6%89%93%E5%8C%85%E4%B8%BA%E5%8E%8B%E7%BC%A9%E5%8C%85"><span class="toc-number">5.</span> <span class="toc-text">下载并打包为压缩包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%90%8D%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98"><span class="toc-number">5.1.</span> <span class="toc-text">文件名乱码问题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#el-tree-select"><span class="toc-number">6.</span> <span class="toc-text">el-tree-select</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%80%9A%E8%BF%87key%E7%9A%84%E6%96%B9%E5%BC%8F%E5%AF%B9%E5%AD%90%E7%BB%84%E4%BB%B6%E5%BC%BA%E5%88%B6%E6%B8%B2%E6%9F%93"><span class="toc-number">7.</span> <span class="toc-text">通过key的方式对子组件强制渲染</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%89%8B%E6%9C%BA%E9%80%82%E9%85%8D"><span class="toc-number">8.</span> <span class="toc-text">手机适配</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#taliwincss-%E5%B8%B8%E7%94%A8%E6%A0%B7%E5%BC%8F"><span class="toc-number">8.1.</span> <span class="toc-text">taliwincss 常用样式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AA%92%E4%BD%93%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.2.</span> <span class="toc-text">媒体查询</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vue-3-router-addroute-no-match-found"><span class="toc-number">9.</span> <span class="toc-text">Vue 3 router addroute no match found</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#easyexcel-%E6%8A%A5%E9%94%99ExceptionInInitializerError"><span class="toc-number">10.</span> <span class="toc-text">easyexcel 报错ExceptionInInitializerError</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#java%E8%87%AA%E5%B8%A6ZipOutputStream%E5%8E%8B%E7%BC%A9%E6%96%87%E4%BB%B6%E5%90%8D%E4%B8%BA%E4%B8%AD%E6%96%87%E7%9A%84%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98"><span class="toc-number">11.</span> <span class="toc-text">java自带ZipOutputStream压缩文件名为中文的乱码问题</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ElementPlus-upload-fileList%E4%B8%BA%E7%A9%BA"><span class="toc-number">12.</span> <span class="toc-text">ElementPlus upload fileList为空</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B8%A6%E5%B1%9E%E6%80%A7%E6%90%9C%E7%B4%A2"><span class="toc-number">13.</span> <span class="toc-text">带属性搜索</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%99%BA%E8%83%BD%E5%8C%B9%E9%85%8D%E5%B2%97%E4%BD%8D"><span class="toc-number">14.</span> <span class="toc-text">智能匹配岗位</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5excel"><span class="toc-number">15.</span> <span class="toc-text">导入excel</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GPT%E6%96%B0%E5%BB%BA%E8%A1%A8%E6%83%AF%E4%BE%8B"><span class="toc-number">16.</span> <span class="toc-text">GPT新建表惯例</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GPT%E6%96%B0%E5%BB%BA%E8%A1%A8%E6%A0%BC%E5%AF%BC%E5%85%A5%E8%A7%84%E8%8C%83%E6%83%AF%E4%BE%8B"><span class="toc-number">17.</span> <span class="toc-text">GPT新建表格导入规范惯例</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%A9%E7%94%A8-CASE-%E8%AF%AD%E5%8F%A5%EF%BC%8C%E5%B0%86-money-%E8%BD%AC%E6%8D%A2%E4%B8%BA%E6%95%B0%E5%80%BC%E5%90%8E%E6%8C%89%E4%BB%8E%E9%AB%98%E5%88%B0%E4%BD%8E%E6%8E%92%E5%BA%8F"><span class="toc-number">18.</span> <span class="toc-text">利用 CASE 语句，将 money 转换为数值后按从高到低排序</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E8%AE%A9item-title%E9%83%A8%E5%88%86%E7%9A%84p%E6%A0%87%E7%AD%BE%E4%BF%9D%E6%8C%81%E5%8F%AA%E6%9C%89%E4%B8%80%E8%A1%8C%EF%BC%8C%E5%A4%9A%E5%A4%84%E4%B8%80%E8%A1%8C%E7%9A%84%E9%83%A8%E5%88%86%E7%94%A8%E2%80%A6%E4%BB%A3%E6%9B%BF"><span class="toc-number">19.</span> <span class="toc-text">如何让item.title部分的p标签保持只有一行，多处一行的部分用…代替</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#esayexcel"><span class="toc-number">20.</span> <span class="toc-text">esayexcel</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#esayexcel%E5%AF%BC%E5%85%A5%E5%A4%B1%E8%B4%A5"><span class="toc-number">20.1.</span> <span class="toc-text">esayexcel导入失败</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#esayexcel%E5%AF%BC%E5%87%BA"><span class="toc-number">20.2.</span> <span class="toc-text">esayexcel导出</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#esayexcel%E6%A0%87%E7%BA%A2%E9%94%99%E8%AF%AF%E9%83%A8%E5%88%86%E6%95%B0%E6%8D%AE%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC"><span class="toc-number">20.3.</span> <span class="toc-text">esayexcel标红错误部分数据的单元格</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vue3-%E6%89%93%E5%8D%B0%E5%AE%9E%E7%8E%B0"><span class="toc-number">21.</span> <span class="toc-text">Vue3 打印实现</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By TEC</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadLivere () {
  if (typeof LivereTower === 'object') {
    window.LivereTower.init()
  }
  else {
    (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
    })(document, 'script');
  }
}

if ('Livere' === 'Livere' || !false) {
  if (false) btf.loadComment(document.getElementById('lv-container'), loadLivere)
  else loadLivere()
}
else {
  function loadOtherComment () {
    loadLivere()
  }
}</script></div><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><div class="aplayer no-destroy" data-id="7766753897" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true"> </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>