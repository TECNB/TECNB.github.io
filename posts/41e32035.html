<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>UbuntuæœåŠ¡å™¨ç«¯éƒ¨ç½²å¤§æ¨¡å‹ | TEC</title><meta name="author" content="TEC"><meta name="copyright" content="TEC"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="UbuntuæœåŠ¡å™¨ç«¯éƒ¨ç½²å¤§æ¨¡å‹è°ƒç”¨Ollamaä¸‹è½½ 1curl -fsSL https:&#x2F;&#x2F;ollama.com&#x2F;install.sh | sh  dockeræ–¹å¼ 1docker run -d --gpus&#x3D;all -v ~&#x2F;ollama:&#x2F;root&#x2F;.ollama -p 11434:11434 --name ollama ollama&#x2F;ollama    1docker run -d -v ~">
<meta property="og:type" content="article">
<meta property="og:title" content="UbuntuæœåŠ¡å™¨ç«¯éƒ¨ç½²å¤§æ¨¡å‹">
<meta property="og:url" content="https://tecnb.github.io/posts/41e32035.html">
<meta property="og:site_name" content="TEC">
<meta property="og:description" content="UbuntuæœåŠ¡å™¨ç«¯éƒ¨ç½²å¤§æ¨¡å‹è°ƒç”¨Ollamaä¸‹è½½ 1curl -fsSL https:&#x2F;&#x2F;ollama.com&#x2F;install.sh | sh  dockeræ–¹å¼ 1docker run -d --gpus&#x3D;all -v ~&#x2F;ollama:&#x2F;root&#x2F;.ollama -p 11434:11434 --name ollama ollama&#x2F;ollama    1docker run -d -v ~">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/TECNB/picgodemo@main/img/Ubuntu%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%A4%A7%E6%A8%A1%E5%9E%8B-cover.png">
<meta property="article:published_time" content="2024-07-25T04:16:33.000Z">
<meta property="article:modified_time" content="2024-07-25T04:16:33.000Z">
<meta property="article:author" content="TEC">
<meta property="article:tag" content="TEC">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/TECNB/picgodemo@main/img/Ubuntu%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%A4%A7%E6%A8%A1%E5%9E%8B-cover.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://tecnb.github.io/posts/41e32035"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="baidu-site-verification" content="code-EeDq654IWe"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'UbuntuæœåŠ¡å™¨ç«¯éƒ¨ç½²å¤§æ¨¡å‹',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-25 12:16:33'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/universe.css"><link rel="stylesheet" href="/css/custom.css"  media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/iconfont/iconfont.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/TECNB/picgodemo@main/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">31</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background: default_top_img"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">TEC</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">UbuntuæœåŠ¡å™¨ç«¯éƒ¨ç½²å¤§æ¨¡å‹</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2024-07-25T04:16:33.000Z" title="å‘è¡¨äº 2024-07-25 12:16:33">2024-07-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-07-25T04:16:33.000Z" title="æ›´æ–°äº 2024-07-25 12:16:33">2024-07-25</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">3.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>15åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="UbuntuæœåŠ¡å™¨ç«¯éƒ¨ç½²å¤§æ¨¡å‹"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="UbuntuæœåŠ¡å™¨ç«¯éƒ¨ç½²å¤§æ¨¡å‹"><a href="#UbuntuæœåŠ¡å™¨ç«¯éƒ¨ç½²å¤§æ¨¡å‹" class="headerlink" title="UbuntuæœåŠ¡å™¨ç«¯éƒ¨ç½²å¤§æ¨¡å‹"></a>UbuntuæœåŠ¡å™¨ç«¯éƒ¨ç½²å¤§æ¨¡å‹</h1><h2 id="è°ƒç”¨Ollama"><a href="#è°ƒç”¨Ollama" class="headerlink" title="è°ƒç”¨Ollama"></a>è°ƒç”¨Ollama</h2><p>ä¸‹è½½</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://ollama.com/install.sh | sh</span><br></pre></td></tr></table></figure>

<p>dockeræ–¹å¼</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --gpus=all -v ~/ollama:/root/.ollama -p 11434:11434 --name ollama ollama/ollama</span><br></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -v ~/ollama:/root/.ollama -p 11434:11434 --name ollama ollama/ollama</span><br></pre></td></tr></table></figure>



<h2 id="å¼€å¯ollamaæœåŠ¡ç«¯"><a href="#å¼€å¯ollamaæœåŠ¡ç«¯" class="headerlink" title="å¼€å¯ollamaæœåŠ¡ç«¯"></a>å¼€å¯ollamaæœåŠ¡ç«¯</h2><p>å¥½åƒä¹Ÿä¸éœ€è¦ï¼Ÿå¯èƒ½æ˜¯ç”¨äºåœ¨åå°è¿è¡Œçš„</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama serve</span><br></pre></td></tr></table></figure>



<h2 id="ä¸‹è½½æ¨¡å‹"><a href="#ä¸‹è½½æ¨¡å‹" class="headerlink" title="ä¸‹è½½æ¨¡å‹"></a>ä¸‹è½½æ¨¡å‹</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama run llama2-chinese:latest</span><br></pre></td></tr></table></figure>

<p>dockeræ–¹å¼</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it ollama ollama run llama2-chinese</span><br></pre></td></tr></table></figure>



<h2 id="è¿è¡Œå¤§æ¨¡å‹WebUI"><a href="#è¿è¡Œå¤§æ¨¡å‹WebUI" class="headerlink" title="è¿è¡Œå¤§æ¨¡å‹WebUI"></a>è¿è¡Œå¤§æ¨¡å‹WebUI</h2><p>æ–‡æ¡£ï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.openwebui.com/getting-started/">ğŸš€ Getting Started | Open WebUI</a></p>
<p>æ­¤å¤„ä½¿ç”¨å¼€æºé¡¹ç›®<code>openwebui</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --gpus=all -d -p 3000:8080 -e HF_ENDPOINT=https://hf-mirror.com/ -e OLLAMA_BASE_URL=http://10.248.68.50:11434 -v ~/open-webui:/app/backend/data --name open-webui --restart always ghcr.io/open-webui/open-webui:main</span><br></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 3000:8080 --add-host=host.docker.internal:host-gateway -v open-webui:/app/backend/data --name open-webui --restart always ghcr.io/open-webui/open-webui:main</span><br></pre></td></tr></table></figure>



<h3 id="BUG"><a href="#BUG" class="headerlink" title="BUG"></a>BUG</h3><ol>
<li>huggingface.co çš„è¿æ¥é—®é¢˜</li>
</ol>
<p>   å»<code>docker logs -f open-webui</code>è·å–åˆ°é”™è¯¯æ—¥å¿—ï¼Œè™½ç„¶æ—¥å¿—è¶…çº§æ— æ•Œé•¿ï¼Œä½†æ˜¯å…³é”®è¯æ˜¯hugging face</p>
<p>   æˆªå–éƒ¨åˆ†æ—¥å¿—</p>
   <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host=<span class="string">&#x27;huggingface.co&#x27;</span>, port=443): Max retries exceeded with url: /sentence-transformers/all-MiniLM-L6-v2/resolve/main/config.json (Caused by ConnectTimeoutError(&lt;urllib3.connection.HTTPSConnection object at 0x7fd5bc4d0510&gt;, <span class="string">&#x27;Connection to huggingface.co timed out. (connect timeout=10)&#x27;</span>))</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>dockerå†…éƒ¨çš„ç½‘ç»œéš”ç¦»é—®é¢˜<br>ollamaä¹Ÿæ˜¯é€šè¿‡dockerè¿›è¡Œéƒ¨ç½²çš„ï¼Œå¦‚æœè¿™æ ·çš„æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªä¸åŒçš„<code>Container</code>ä¸­æ˜¯æ— æ³•é€šè¿‡<code>--add-host=host.docker.internal:host-gateway</code>å‘½ä»¤è¿›è¡Œè¿æ¥çš„ï¼Œéœ€è¦é€šè¿‡IP+åœ°å€çš„æ–¹å¼è¿›è¡Œè®¿é—®æˆ–è€…å°†å…¶æ”¾ç½®åˆ°<code>Compose</code>ä¸­å½¢æˆä¸€ä¸ªå†…éƒ¨ç½‘ç»œ</p>
<p>Linux - Ollama å’Œ Open WebUI åœ¨å®¹å™¨ä¸­ï¼Œåœ¨ä¸åŒçš„ç½‘ç»œä¸­</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/TECNB/picgodemo@main/img/%E6%88%AA%E5%B1%8F2024-07-06%2020.17.33.png" alt="æˆªå±2024-07-06 20.17.33"></p>
<p>Linux - ä¸»æœºæœ¬åœ°ä¸Šçš„Ollamaï¼Œåœ¨å®¹å™¨ä¸­æ‰“å¼€WebUI<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/TECNB/picgodemo@main/img/%E6%88%AA%E5%B1%8F2024-07-06%2020.16.26.png" alt="æˆªå±2024-07-06 20.16.26"><br>Linux - Ollama å’Œ Open WebUI åœ¨åŒä¸€ä¸ª Compose å †æ ˆä¸­</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/TECNB/picgodemo@main/img/%E6%88%AA%E5%B1%8F2024-07-06%2020.17.23.png" alt="æˆªå±2024-07-06 20.17.23"></p>
</li>
</ol>
<h2 id="é€šè¿‡æœåŠ¡å™¨è¿”å›æ•°æ®"><a href="#é€šè¿‡æœåŠ¡å™¨è¿”å›æ•°æ®" class="headerlink" title="é€šè¿‡æœåŠ¡å™¨è¿”å›æ•°æ®"></a>é€šè¿‡æœåŠ¡å™¨è¿”å›æ•°æ®</h2><p>è¿”å›æ ¼å¼å‚è€ƒï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://ollama.fan/reference/api/#endpoints">API å‚è€ƒ - Ollamaä¸­æ–‡ç½‘</a></p>
<p>é»˜è®¤å¯åŠ¨åå°±ä¼šå¯åŠ¨APIçš„æœåŠ¡</p>
<p><code>http://127.0.0.1:11434/api/generate</code></p>
<h2 id="å¾®è°ƒæ¨¡å‹"><a href="#å¾®è°ƒæ¨¡å‹" class="headerlink" title="å¾®è°ƒæ¨¡å‹"></a>å¾®è°ƒæ¨¡å‹</h2><p>ä½¿ç”¨<code>LLaMA-Factory</code>è¿›è¡Œå¾®è°ƒ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## å¯¼å‡ºæ¨¡å‹</span></span><br><span class="line"></span><br><span class="line">åŸæ–‡ï¼š[Ollama è¿è¡Œ GGUF æ¨¡å‹_51CTOåšå®¢_olapæ¨¡å‹](https://blog.51cto.com/u_15588078/10133275<span class="comment">#:~:text=Ollama åŠ è½½GGUFæ¨¡å‹æ–‡ä»¶ 1 1ã€åˆ›å»ºæ¨¡å‹é…ç½®æ–‡ä»¶ åˆ›å»ºä¸€ä¸ªåŒ…å«ä»¥ä¸‹å†…å®¹çš„æ¨¡å‹é…ç½®æ–‡ä»¶ï¼Œæ¯”å¦‚%3A causallm7bq5.mf è¿™ä¸ªæ–‡ä»¶åï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š FROM,ollama run c7b &quot;è¯·å†™ä¸€ä¸ªæƒ…è‰²å¹½é»˜ç¬‘è¯&quot; 1. æ‚¨å¾—åˆ°çš„ç»“æœå°†ä¸æˆ‘å¾—åˆ°çš„ç»“æœä¸åŒï¼Œå› ä¸ºè¿™äº›æ¨¡å‹æ˜¯éšæœºçš„ï¼Œä¸‹é¢æ˜¯æˆ‘åœ¨å…¶ä¸­ä¸€æ¬¡å°è¯•ä¸­å¾—åˆ°çš„è¾“å‡ºï¼š ä¸åŒçš„å°è¯•ï¼Œä¼šæœ‰ä¸åŒçš„æƒŠå–œï¼Œ )</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è¦æ±‚è¿›è¡ŒINTé‡åŒ–ï¼Œå¯¼å‡ºä¸ºåç¼€ä¸º`.gguf`çš„æ¨¡å‹</span><br><span class="line"></span><br><span class="line">ç„¶åæ–°å»ºä¸€ä¸ª`.mf`ï¼Œé‡Œé¢æ˜¯å¯¼å‡ºåçš„æ¨¡å‹çš„ä½ç½®</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">FROM /Users/tec/Downloads/model-unsloth.Q4_K_M.gguf</span><br></pre></td></tr></table></figure>

<p>ç„¶åè¿è¡Œä¸‹é¢çš„å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama create nftchat -f ./causallm7bq5.mf</span><br></pre></td></tr></table></figure>



<h2 id="APIè°ƒç”¨"><a href="#APIè°ƒç”¨" class="headerlink" title="APIè°ƒç”¨"></a>APIè°ƒç”¨</h2><p>ChatGLM3&#x2F;openai_api_demo&#x2F;api_server.py</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python api_server.py</span><br></pre></td></tr></table></figure>



<p>LLaMA-Factory&#x2F;src&#x2F;api.py</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CUDA_VISIBLE_DEVICES=0 API_PORT=8000 python src/api.py \</span><br><span class="line">--model_name_or_path /home/ypy/langchan/LLaMA-Factory/saves/AIChat \</span><br><span class="line">--template chatglm2 </span><br><span class="line">--infer_backend vllm </span><br><span class="line">--vllm_enforce_eager</span><br></pre></td></tr></table></figure>



<p>vLLM</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python -m vllm.entrypoints.openai.api_server \</span><br><span class="line">   --model /home/ypy/langchan/LLaMA-Factory/saves/AIChat \</span><br><span class="line">   --trust-remote-code \</span><br><span class="line">   --served-model-name AIChat \</span><br><span class="line">   --port 8000</span><br></pre></td></tr></table></figure>



<h1 id="UbuntuæœåŠ¡å™¨ç«¯éƒ¨ç½²Stable-Diffusion"><a href="#UbuntuæœåŠ¡å™¨ç«¯éƒ¨ç½²Stable-Diffusion" class="headerlink" title="UbuntuæœåŠ¡å™¨ç«¯éƒ¨ç½²Stable Diffusion"></a>UbuntuæœåŠ¡å™¨ç«¯éƒ¨ç½²Stable Diffusion</h1><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/AUTOMATIC1111/stable-diffusion-webui.git</span><br></pre></td></tr></table></figure>

<p>dockerå®‰è£…</p>
<p>æ³¨æ„éœ€è¦æœ€æ–°ç‰ˆæœ¬çš„compose</p>
<p>ä»¥Ubuntu 22.04ä¸ºä¾‹ï¼Œé‡‡ç”¨AbdBarhoç»´æŠ¤çš„docker-composeï¼Œä»…æ”¯æŒNvidiaæ˜¾å¡ã€‚</p>
<ol>
<li>æ‹·è´AbdBarhoçš„ä¿å­˜åº“</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/AbdBarho/stable-diffusion-webui-docker.git</span><br><span class="line"><span class="built_in">cd</span> stable-diffusion-webui-docker</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>å®‰è£…ä¾èµ–å¥—ä»¶ï¼Œè¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨ä¸‹è½½ä¸€ä¸ªStable Diffusionçš„æ¨¡å‹ã€‚</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker compose --profile download up --build</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>å¯åŠ¨å®¹å™¨ï¼Œé€‰å–autoä»£è¡¨å¯åŠ¨AUTOMATIC1111å¼€å‘çš„WebUI</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker compose --profile auto up --build</span><br></pre></td></tr></table></figure>



<h2 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h2><p>è¿™é‡Œæ³¨æ„<code>webui.py</code>çš„ä½ç½®ï¼Œä¸‹é¢çš„å‘½ä»¤ï¼Œä¼šæ ¹æ®ç³»ç»Ÿé…ç½®ï¼Œé»˜è®¤é…ç½®å¥½é¡¹ç›®ç¯å¢ƒï¼Œå¹¶å®‰è£…å¥½é¡¹ç›®ä¾èµ–åŒ…</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./webui.sh</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„éœ€è¦å…ˆä½¿ç”¨å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> http_proxy=<span class="string">&quot;http://127.0.0.1:7890&quot;</span></span><br><span class="line"><span class="built_in">export</span> https_proxy=<span class="string">&quot;http://127.0.0.1:7890&quot;</span></span><br></pre></td></tr></table></figure>





<p>ä¸‹é¢åŒæ—¶é…ç½®äº†å¤–ç½‘é€šè¿‡IPè®¿é—®ï¼Œä»¥åŠAPIè®¿é—®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./webui.sh --listen --api</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„è¿™äº›å‘½ä»¤å¯ä»¥ç›´æ¥åœ¨<code>webui-user.sh</code>ä¸­è¿›è¡Œé›†æˆ</p>
<p>åœ¨<code>COMMANDLINE_ARGS</code>ä¸­æŒ‡å®šéœ€è¦çš„å‘½ä»¤ï¼Œä¹‹åç›´æ¥æ‰§è¡Œ<code>./webui.sh</code>å°±å¯ä»¥æºå¸¦ä¸Šè¿™äº›å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#########################################################</span></span><br><span class="line"><span class="comment"># Uncomment and change the variables below to your need:#</span></span><br><span class="line"><span class="comment">#########################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Install directory without trailing slash</span></span><br><span class="line"><span class="comment">#install_dir=&quot;/home/$(whoami)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Name of the subdirectory</span></span><br><span class="line"><span class="comment">#clone_dir=&quot;stable-diffusion-webui&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Commandline arguments for webui.py, for example: export COMMANDLINE_ARGS=&quot;--medvram --opt-split-attention&quot;</span></span><br><span class="line"><span class="built_in">export</span> COMMANDLINE_ARGS=<span class="string">&quot;--listen --api --enable-insecure-extension-access&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># python3 executable</span></span><br><span class="line"><span class="comment">#python_cmd=&quot;python3&quot;</span></span><br></pre></td></tr></table></figure>



<h3 id="å¯åŠ¨æŠ¥é”™"><a href="#å¯åŠ¨æŠ¥é”™" class="headerlink" title="å¯åŠ¨æŠ¥é”™"></a>å¯åŠ¨æŠ¥é”™</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cannot locate TCMalloc (improves CPU memory usage)</span><br></pre></td></tr></table></figure>

<p><strong>è§£å†³</strong>ï¼šå®‰è£… <code>libgoogle-perftools4</code> å’Œ <code>libtcmalloc-minimal4</code> åº“ã€‚è¿™ä¸¤ä¸ªåº“æ˜¯ Google å¼€æºçš„æ€§èƒ½åˆ†æå·¥å…·åº“ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…ä¼˜åŒ–ç¨‹åºæ€§èƒ½ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libgoogle-perftools4 libtcmalloc-minimal4 -y</span><br></pre></td></tr></table></figure>



<h2 id="è®¿é—®"><a href="#è®¿é—®" class="headerlink" title="è®¿é—®"></a>è®¿é—®</h2><p>è¿›å…¥ä¸‹é¢çš„åœ°å€</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:7860</span><br></pre></td></tr></table></figure>

<p>APIè®¿é—®åˆ™ä½¿ç”¨ä¸‹é¢çš„åœ°å€</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST http://localhost:7860/sdapi/v1/txt2img -H <span class="string">&quot;Content-Type: application/json&quot;</span> -d <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">    &quot;prompt&quot;: &quot;a futuristic cityscape&quot;,</span></span><br><span class="line"><span class="string">    &quot;steps&quot;: 20</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="æ·»åŠ æ‰©å±•"><a href="#æ·»åŠ æ‰©å±•" class="headerlink" title="æ·»åŠ æ‰©å±•"></a>æ·»åŠ æ‰©å±•</h2><h3 id="å®‰è£…ä¸­æ–‡å’ŒåŒè¯­ç•Œé¢"><a href="#å®‰è£…ä¸­æ–‡å’ŒåŒè¯­ç•Œé¢" class="headerlink" title="å®‰è£…ä¸­æ–‡å’ŒåŒè¯­ç•Œé¢"></a>å®‰è£…ä¸­æ–‡å’ŒåŒè¯­ç•Œé¢</h3><ul>
<li>æ­£ä½“ä¸­æ–‡æ‰©å……åŠŸèƒ½æ¥æºï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/benlisquare/stable-diffusion-webui-localization-zh_TW">benlisquare&#x2F;stable-diffusion-webui-localization-zh_TW</a></li>
<li>ç®€ä½“ä¸­æ–‡æ‰©å……åŠŸèƒ½æ¥æºï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/dtlnor/stable-diffusion-webui-localization-zh_CN">dtlnor&#x2F;stable-diffusion-webui-localization-zh_CN</a></li>
</ul>
<p>Stable Diffusion WebUIå¯ä»¥é€šè¿‡æ‰©å……åŠŸèƒ½å°†ç•Œé¢å˜æˆä¸­æ–‡ã€‚å¦‚æœæ‚¨æƒ³ååŠ©ç¿»è¯‘ï¼Œè¯·ç‚¹å‡»ä»¥ä¸Šçš„Githubä¿å­˜åº“é“¾æ¥ï¼Œå¸®å¸®ä»–ä»¬ã€‚</p>
<ol>
<li>è¿›å…¥Extensionsé¡µé¢ï¼Œå–æ¶ˆå‹¾é€‰<code>localization</code>ï¼Œå†ç‚¹å‡»<code>Load from:</code>ï¼Œæ‰¾åˆ°<code>zh_TW Localization</code>æˆ–<code>zh_CN Localization</code>ï¼Œç‚¹å‡»Installã€‚</li>
</ol>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.stablediffusion.cn/images/localizations-1.webp"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/TECNB/picgodemo@main/img/localizations-1.webp" alt="img"></a></p>
<ol start="2">
<li>åˆ°Settingsé¡µé¢ï¼Œæ‰¾åˆ°å·¦è¾¹çš„Localizationï¼Œç‚¹å‡»<code>zh-tw</code>æˆ–<code>zh-cn</code>ï¼Œå†ç‚¹å‡»<code>Apply Settings</code>ã€‚</li>
</ol>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.stablediffusion.cn/images/localizations-2.webp"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/TECNB/picgodemo@main/img/localizations-2.webp" alt="img"></a></p>
<ol start="3">
<li>ä¹‹åé‡å¯WebUIï¼Œç•Œé¢å°±ä¼šå˜æˆä¸­æ–‡äº†ã€‚</li>
</ol>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/journey-ad/sd-webui-bilingual-localization/blob/main/README_ZH.md">sd-webui-bilingual-localization&#x2F;README_ZH.md at main Â· journey-ad&#x2F;sd-webui-bilingual-localization (github.com)</a></p>
<p>ç”±äºSD WebUIçš„æ‰©å……åŠŸèƒ½å‘å±•å¤ªå¿«ï¼Œç¿»è¯‘å¯èƒ½è·Ÿä¸ä¸Šï¼Œå»ºè®®å¦å¤–å®‰è£…åŒè¯­å¯¹ç…§<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/journey-ad/sd-webui-bilingual-localization">sd-webui-bilingual-localization</a>ï¼ŒåŒæ—¶æ˜¾ç¤ºä¸­æ–‡å’Œè‹±æ–‡çš„æ–‡æœ¬ï¼Œè¿™æ ·çœ‹æ•™å­¦æ—¶å°±ä¸ä¼šæ‰¾æ— æŒ‰é’®äº†ã€‚</p>
<p>åŒè¯­æ‰©å……åŠŸèƒ½å®‰è£…æ–¹æ³•ï¼šåœ¨Extensionsé¡µé¢æŒ‰<code>Install from URL</code>ï¼Œå¡«å…¥<code>https://github.com/journey-ad/sd-webui-bilingual-localization</code>ï¼Œå†æŒ‰<code>Install</code>ã€‚</p>
<p>åœ¨æ¿€æ´»åŒè¯­æ‰©å……åŠŸèƒ½å‰ï¼Œè¦åˆ°Settings â†’ User interface â†’ Localizationè®¾ä¸ºNone</p>
<p>æ¥ç€åˆ°<code>Bilingual Localization</code>ä¸­å»æŠŠè¿™é‡Œé¢çš„<code>Localization</code>ä¿®æ”¹ä¸º<code>zh_CN</code>ï¼Œå†é‡å¯WebUIæ‰ä¼šç”Ÿæ•ˆã€‚</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.stablediffusion.cn/images/localizations-3.webp"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/TECNB/picgodemo@main/img/localizations-3.webp" alt="img"></a></p>
<h3 id="BUG-1"><a href="#BUG-1" class="headerlink" title="BUG"></a>BUG</h3><p>æŠ¥é”™å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AssertionError: extension access disabled because of <span class="built_in">command</span> line flags</span><br></pre></td></tr></table></figure>

<p>åŸå› æ˜¯å¼€å¯äº†<code>--listen</code>çš„å‘½ä»¤ï¼Œå®˜æ–¹å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œåœ¨å¤–ç½‘è®¿é—®æ—¶æ˜¯ä¸èƒ½å®‰è£…ä»»ä½•æ‰©å±•çš„ï¼Œæ‰€ä»¥éœ€è¦åŠ ä¸Š<code>--enable-insecure-extension-access</code>çš„å‘½ä»¤ï¼Œç”¨äºç»•å¼€è¿™ä¸ªå®‰å…¨é€‰é¡¹</p>
<h2 id="å¤§æ¨¡å‹ï¼ˆåŸºåº§æ¨¡å‹ï¼Œåº•æ¨¡ï¼‰æ·»åŠ "><a href="#å¤§æ¨¡å‹ï¼ˆåŸºåº§æ¨¡å‹ï¼Œåº•æ¨¡ï¼‰æ·»åŠ " class="headerlink" title="å¤§æ¨¡å‹ï¼ˆåŸºåº§æ¨¡å‹ï¼Œåº•æ¨¡ï¼‰æ·»åŠ "></a>å¤§æ¨¡å‹ï¼ˆåŸºåº§æ¨¡å‹ï¼Œåº•æ¨¡ï¼‰æ·»åŠ </h2><p>å¯ä»¥è¿›å…¥<code>https://civitai.com/</code>çš„Modelséƒ¨åˆ†è¿›è¡Œä¸‹è½½ï¼Œåç¼€ä¸º<code>ckpt</code>ï¼Œä¸º<code>Checkpoint</code>çš„ç¼©å†™</p>
<p>æ¨¡å‹æƒé‡ä¸‹è½½å¥½åï¼Œéœ€è¦å°†æ¨¡å‹æ”¾åˆ°å¯¹åº”çš„æ–‡ä»¶å¤¹ä¸­ï¼Œè¿™é‡Œæœ€å¸¸ç”¨çš„æ˜¯ï¼šå¤§æ¨¡å‹ å’Œ å¾®è°ƒçš„LoRA æ¨¡å‹ï¼Œåˆ†åˆ«æ”¾åœ¨ <code>models/stable-diffusion</code> å’Œ <code>models/Lora</code>ä¸‹ï¼Œå¯åŠ¨åï¼ŒWebUI ä¼šè‡ªåŠ¨ä»è¿™å‡ ä¸ªæ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°å¯¹åº”çš„æ¨¡å‹</p>
<p>ç±»æ¢µé«˜ï¼š</p>
<p>1ã€Van Gogh Diffusionï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://civitai.com/models/91/van-gogh-diffusion">Van Gogh Diffusion - V1 | Stable Diffusion Checkpoint | Civitai</a></p>
<p>2ã€Van Gogh Styleï¼ˆLoraï¼‰ï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://civitai.com/models/100873/van-gogh-style">å¥‡ç»´æ³° |å…±äº«æ‚¨çš„æ¨¡å‹ (civitai.com)</a></p>
<p>æ°´å¢¨é£ï¼š</p>
<p>1ã€å›½ç”»å±±æ°´å’Œæ°´å¢¨å±±æ°´Chinese Landscape Artï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://civitai.com/models/120298/chinese-landscape-art">å›½ç”»å±±æ°´å’Œæ°´å¢¨å±±æ°´Chinese Landscape Art - v1.0 | Stable Diffusion Checkpoint | Civitai</a></p>
<p>åƒç´ é£ï¼š</p>
<p>1ã€PixelStyleCKPT&#x2F;åƒç´ ç”»ï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://civitai.com/models/85953/pixelstyleckpt">PixelStyleCKPT&#x2F;åƒç´ ç”» - Strength:0.7 | Stable Diffusion Checkpoint | Civitai</a></p>
<p>2ã€åƒç´ äººï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://civitai.com/models/44960/mpixel">Application error: a client-side exception has occurred (civitai.com)</a></p>
<p>3ã€Pixel Art XLï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://civitai.com/models/120096/pixel-art-xl">Pixel Art XL - v1.1 | Stable Diffusion LoRA | Civitai</a></p>
<p>è«å¥ˆé£ï¼š</p>
<p>ä¸‹é¢ä¸ºloraæ¨¡å‹ï¼Œloraè¿˜ä¸çŸ¥é“æ€ä¹ˆä½¿ç”¨</p>
<p>1ã€Claude Monet&#x2F;Oscar-Claude Monet styleï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://civitai.com/models/73902/claude-monetoscar-claude-monet-style">Claude Monet&#x2F;Oscar-Claude Monet style - v2.0 | Stable Diffusion LoRA | Civitai</a></p>
<p>èµ›ä¼¯æœ‹å…‹é£ï¼š</p>
<p>1ã€èµ›åšä¸–ç•Œ&#x2F;Cyberworld&#x2F;èµ›åšæœ‹å…‹åœºæ™¯ Loraï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://civitai.com/models/95656/cyberworld-lora">èµ›åšä¸–ç•Œ&#x2F;Cyberworld&#x2F;èµ›åšæœ‹å…‹åœºæ™¯ Lora - v1.0 | Stable Diffusion LoRA | Civitai</a></p>
<p>ç§‘å¹»é£ï¼š</p>
<p>1ã€XSArchi_127æ–°ç§‘å¹»Neo Sci-Fiï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://civitai.com/models/100287/xsarchi127neo-sci-fi">XSArchi_127æ–°ç§‘å¹»Neo Sci-Fi - v1.0 | Stable Diffusion LoRA | Civitai</a></p>
<h2 id="æ–‡ç”Ÿå›¾APIå‚æ•°è°ƒæ•´"><a href="#æ–‡ç”Ÿå›¾APIå‚æ•°è°ƒæ•´" class="headerlink" title="æ–‡ç”Ÿå›¾APIå‚æ•°è°ƒæ•´"></a>æ–‡ç”Ÿå›¾APIå‚æ•°è°ƒæ•´</h2><p>å‚æ•°å«ä¹‰ï¼š</p>
<p>åœ¨Stable Diffusion Web UIä¸­ï¼Œä½¿ç”¨APIæ—¶å¯ä»¥ä¼ é€’å„ç§å‚æ•°æ¥æ§åˆ¶å›¾åƒç”Ÿæˆçš„è¿‡ç¨‹ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„APIå‚æ•°åŠå…¶è¯´æ˜ï¼š</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/Python_anning/article/details/135269356">å…¨ç½‘æœ€å…¨stable diffusion webui APIè°ƒç”¨ç¤ºä¾‹ï¼ŒåŒ…å«controlnethå’Œsegment anythingçš„APIï¼ˆé™„jsonç¤ºä¾‹ï¼‰-CSDNåšå®¢</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;prompt&quot;</span>: <span class="string">&quot;æç¤ºè¯&quot;</span>,</span><br><span class="line">    <span class="string">&quot;negative_prompt&quot;</span>: <span class="string">&quot;åå‘æç¤ºè¯&quot;</span>,</span><br><span class="line">    <span class="string">&quot;seed&quot;</span>: -1,  <span class="comment"># éšæœºç§å­</span></span><br><span class="line">    <span class="string">&quot;sampler_name&quot;</span>: <span class="string">&quot;å–æ ·å™¨ï¼ˆä¹‹é—´å¤åˆ¶webuiçš„åå­—å°±è¡Œï¼‰&quot;</span>,</span><br><span class="line">    <span class="string">&quot;cfg_scale&quot;</span>: 7.5,  <span class="comment"># æç¤ºè¯ç›¸å…³æ€§ è¶Šå¤§è¶Šæ¥è¿‘æç¤ºè¯</span></span><br><span class="line">    <span class="string">&quot;width&quot;</span>: 640,  <span class="comment"># å®½ ï¼ˆæ³¨æ„è¦è¢«16æ•´é™¤ï¼‰</span></span><br><span class="line">    <span class="string">&quot;height&quot;</span>: 360,  <span class="comment"># é«˜ ï¼ˆæ³¨æ„è¦è¢«16æ•´é™¤ï¼‰</span></span><br><span class="line">    <span class="string">&quot;batch_size&quot;</span>: 4,  <span class="comment"># æ‰¹é‡æ•°é‡ å¹¶è¡Œ æ˜¾å­˜ä¸å¤Ÿä¼šçˆ†æ˜¾å­˜</span></span><br><span class="line">    <span class="string">&quot;n_iter&quot;</span>: 4,  <span class="comment"># æ‰¹é‡æ•°é‡ é˜Ÿåˆ— æ˜¾å­˜ä¸å¤Ÿæ’é˜Ÿä¸€ä¸ªä¸€ä¸ªæ¥ å’Œ batch_size äºŒé€‰ä¸€</span></span><br><span class="line">    <span class="string">&quot;steps&quot;</span>: 30,  <span class="comment"># è¿­ä»£æ­¥æ•°</span></span><br><span class="line">    <span class="string">&quot;return_grid&quot;</span>: True,  <span class="comment"># è¿”å›ç½‘æ ¼é¢„è§ˆ xl-base å¥½åƒæ²¡ç”¨</span></span><br><span class="line">    <span class="string">&quot;restore_faces&quot;</span>: True,  <span class="comment"># è„¸éƒ¨ä¿®å¤</span></span><br><span class="line">    <span class="string">&quot;send_images&quot;</span>: True,  <span class="comment"># æ˜¯å¦åœ¨å“åº”ä¸­è¿”å›ç”Ÿæˆçš„å›¾åƒ</span></span><br><span class="line">    <span class="string">&quot;save_images&quot;</span>: False,  <span class="comment"># æ˜¯å¦ä¿å­˜ç”Ÿæˆçš„å›¾åƒ ä¸€èˆ¬apiè®¾ç½®æˆFalse</span></span><br><span class="line">    <span class="string">&quot;do_not_save_samples&quot;</span>: False,  <span class="comment"># æ˜¯å¦ä¿å­˜samples ä¸€èˆ¬apiè®¾ç½®æˆFalse</span></span><br><span class="line">    <span class="string">&quot;do_not_save_grid&quot;</span>: False,  <span class="comment"># æ˜¯å¦ä¿å­˜ç½‘æ ¼çš„å›¾åƒ ä¸€èˆ¬apiè®¾ç½®æˆFalse</span></span><br><span class="line">    <span class="comment"># ä¸‹é¢çš„å¾ˆå°‘ç”¨</span></span><br><span class="line">    <span class="string">&quot;enable_hr&quot;</span>: True,  <span class="comment"># æ˜¯å¦å¼€å¯é«˜æ¸…ä¿®å¤</span></span><br><span class="line">    <span class="string">&quot;denoising_strength&quot;</span>: 0.5,  <span class="comment"># å»å™ªå¼ºåº¦ è¦æ±‚enable_hr = True</span></span><br><span class="line">    <span class="string">&quot;firstphase_width&quot;</span>: 0,</span><br><span class="line">    <span class="comment"># firstphase_width å’Œfirstphase_height å®šä¹‰äº†å›¾åƒçš„åˆå§‹åˆ†è¾¨ç‡ã€‚åœ¨å›¾åƒç”Ÿæˆçš„ç¬¬ä¸€é˜¶æ®µï¼Œè¿™äº›å€¼å†³å®šäº†å›¾åƒçš„å¤§å°ã€‚å¦‚æœè¿™äº›å€¼è®¾ç½®ä¸º0ï¼Œç³»ç»Ÿå¯èƒ½ä¼šä½¿ç”¨é»˜è®¤æˆ–é¢„è®¾çš„åˆ†è¾¨ç‡ã€‚</span></span><br><span class="line">    <span class="string">&quot;firstphase_height&quot;</span>: 0,</span><br><span class="line">    <span class="string">&quot;hr_scale&quot;</span>: 2,  <span class="comment"># æ”¾å¤§å€æ•° å¯¹åº”webui Upscale by</span></span><br><span class="line">    <span class="string">&quot;hr_upscaler&quot;</span>: <span class="string">&quot;string&quot;</span>,  <span class="comment"># å¯¹åº”webui çš„ Upscaler</span></span><br><span class="line">    <span class="string">&quot;hr_second_pass_steps&quot;</span>: 0,  <span class="comment"># è¿­ä»£æ­¥æ•° å¯¹åº”webui çš„ Hires stepsã€‚</span></span><br><span class="line">    <span class="string">&quot;hr_resize_x&quot;</span>: 0,  <span class="comment"># ä¸æ”¾å¤§ï¼ŒæŒ‡å®šå®½é«˜ å¯¹åº”webui Resize width to å’ŒResize height to</span></span><br><span class="line">    <span class="string">&quot;hr_resize_y&quot;</span>: 0,  <span class="comment"># ä¸æ”¾å¤§ï¼ŒæŒ‡å®šå®½é«˜ å¯¹åº”webui Resize width to å’ŒResize height to</span></span><br><span class="line">    <span class="string">&quot;hr_checkpoint_name&quot;</span>: <span class="string">&quot;string&quot;</span>,  <span class="comment"># é«˜åˆ†è¾¨ç‡æ¨¡å¼ä¸‹ä½¿ç”¨çš„å¤§æ¨¡å‹æ˜µç§°ã€‚</span></span><br><span class="line">    <span class="string">&quot;hr_sampler_name&quot;</span>: <span class="string">&quot;string&quot;</span>,  <span class="comment"># é«˜åˆ†è¾¨ç‡æ¨¡å¼ä¸‹ä½¿ç”¨çš„é‡‡æ ·å™¨åç§°ã€‚</span></span><br><span class="line">    <span class="string">&quot;hr_prompt&quot;</span>: <span class="string">&quot;&quot;</span>,  <span class="comment"># é«˜åˆ†è¾¨ç‡æ¨¡å¼ä¸‹ä½¿ç”¨çš„æç¤ºè¯åç§°ã€‚</span></span><br><span class="line">    <span class="string">&quot;hr_negative_prompt&quot;</span>: <span class="string">&quot;&quot;</span>,  <span class="comment"># é«˜åˆ†è¾¨ç‡æ¨¡å¼ä¸‹ä½¿ç”¨çš„åå‘æç¤ºè¯åç§°ã€‚</span></span><br><span class="line">    <span class="string">&quot;override_settings&quot;</span>: &#123;</span><br><span class="line">          <span class="string">&quot;sd_model_checkpoint&quot;</span>: <span class="string">&quot;sd_xl_base_1.0.safetensors [31e35c80fc]&quot;</span>,  <span class="comment"># æŒ‡å®šå¤§æ¨¡å‹</span></span><br><span class="line">          <span class="string">&quot;sd_vae&quot;</span>: <span class="string">&quot;Automatic&quot;</span>,  <span class="comment"># æŒ‡å®švae é»˜è®¤è‡ªåŠ¨</span></span><br><span class="line">      &#125;,</span><br><span class="line">    <span class="string">&quot;override_settings_restore_afterwards&quot;</span>: True <span class="comment"># override_settings æ˜¯å¦åœ¨ä¹‹åæ¢å¤è¦†ç›–çš„è®¾ç½® é»˜è®¤æ˜¯True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="é€šç”¨å‚æ•°"><a href="#é€šç”¨å‚æ•°" class="headerlink" title="é€šç”¨å‚æ•°"></a>é€šç”¨å‚æ•°</h3><p>è¿™äº›å‚æ•°é€‚ç”¨äºå¤§å¤šæ•°APIç«¯ç‚¹ï¼Œä¾‹å¦‚<code>/sdapi/v1/txt2img</code>å’Œ<code>/sdapi/v1/img2img</code>ã€‚</p>
<ul>
<li><code>prompt</code> (str): æ–‡æœ¬æç¤ºï¼Œç”¨äºæè¿°è¦ç”Ÿæˆçš„å›¾åƒå†…å®¹ã€‚ä¾‹å¦‚ï¼šâ€a futuristic cityscapeâ€ã€‚</li>
<li><code>steps</code> (int): é‡‡æ ·æ­¥éª¤æ•°ã€‚å€¼è¶Šé«˜ï¼Œå›¾åƒè´¨é‡è¶Šå¥½ï¼Œä½†ç”Ÿæˆæ—¶é—´ä¹Ÿè¶Šé•¿ã€‚å¸¸ç”¨å€¼åœ¨20-50ä¹‹é—´ã€‚</li>
<li><code>sampler_index</code> (int): é‡‡æ ·æ–¹æ³•ç´¢å¼•ï¼Œé»˜è®¤ä¸º0ã€‚å¯ä»¥ä½¿ç”¨ä¸åŒçš„é‡‡æ ·æ–¹æ³•ï¼ˆä¾‹å¦‚DDIMã€PLMSï¼‰ã€‚</li>
<li><code>cfg_scale</code> (float): Classifier-Free Guidance (CFG) æ¯”ä¾‹ï¼Œæ§åˆ¶ç”Ÿæˆå›¾åƒä¸æç¤ºçš„ç›¸å…³æ€§ã€‚å€¼è¶Šé«˜ï¼Œå›¾åƒè¶Šæ¥è¿‘æç¤ºå†…å®¹ã€‚å¸¸ç”¨å€¼åœ¨7-15ä¹‹é—´ã€‚</li>
<li><code>seed</code> (int): éšæœºç§å­ï¼Œç”¨äºæ§åˆ¶ç”Ÿæˆå›¾åƒçš„éšæœºæ€§ã€‚ç›¸åŒçš„ç§å­å’Œå‚æ•°ä¼šç”Ÿæˆç›¸åŒçš„å›¾åƒã€‚</li>
<li><code>height</code> (int): ç”Ÿæˆå›¾åƒçš„é«˜åº¦ï¼Œé»˜è®¤å€¼é€šå¸¸æ˜¯512ã€‚</li>
<li><code>width</code> (int): ç”Ÿæˆå›¾åƒçš„å®½åº¦ï¼Œé»˜è®¤å€¼é€šå¸¸æ˜¯512ã€‚</li>
<li><code>batch_size</code> (int): ä¸€æ¬¡ç”Ÿæˆçš„å›¾åƒæ•°é‡ã€‚</li>
<li><code>n_iter</code> (int): ç”Ÿæˆå›¾åƒçš„è¿­ä»£æ¬¡æ•°ã€‚ä¸€æ¬¡è¯·æ±‚ä¸­ç”Ÿæˆçš„å›¾åƒæ€»æ•°ç­‰äº<code>batch_size * n_iter</code>ã€‚</li>
<li><code>negative_prompt</code> (str): è´Ÿé¢æç¤ºï¼Œç”¨äºæè¿°ä¸å¸Œæœ›åœ¨å›¾åƒä¸­å‡ºç°çš„å†…å®¹ã€‚</li>
<li><code>eta</code> (float): DDIMé‡‡æ ·ä¸­çš„etaå‚æ•°ï¼Œæ§åˆ¶éšæœºæ€§ã€‚</li>
<li><code>ckpt</code>:åœ¨APIè¯·æ±‚ä¸­ï¼Œé€šè¿‡æŒ‡å®šckptæˆ–modelå‚æ•°æ¥é€‰æ‹©è¦ä½¿ç”¨çš„æ¨¡å‹</li>
</ul>
<h3 id="ç‰¹å®šå‚æ•°"><a href="#ç‰¹å®šå‚æ•°" class="headerlink" title="ç‰¹å®šå‚æ•°"></a>ç‰¹å®šå‚æ•°</h3><p>è¿™äº›å‚æ•°é€‚ç”¨äºç‰¹å®šçš„APIç«¯ç‚¹ï¼Œä¾‹å¦‚<code>/sdapi/v1/img2img</code>ã€‚</p>
<ul>
<li><code>init_images</code> (list of str): è¾“å…¥å›¾åƒçš„Base64ç¼–ç åˆ—è¡¨ï¼Œç”¨äºimg2imgä»»åŠ¡ã€‚</li>
<li><code>denoising_strength</code> (float): é™å™ªå¼ºåº¦ï¼Œç”¨äºimg2imgä»»åŠ¡ã€‚å€¼è¶Šé«˜ï¼Œç”Ÿæˆå›¾åƒä¸è¾“å…¥å›¾åƒçš„å·®å¼‚è¶Šå¤§ã€‚å¸¸ç”¨å€¼åœ¨0.2-0.8ä¹‹é—´ã€‚</li>
<li><code>mask</code> (str): æ©ç å›¾åƒçš„Base64ç¼–ç ï¼Œç”¨äºæŒ‡å®šå›¾åƒçš„å“ªäº›éƒ¨åˆ†éœ€è¦é‡ç»˜ã€‚</li>
<li><code>inpainting_fill</code> (int): ä¿®è¡¥æ—¶ä½¿ç”¨çš„å¡«å……æ–¹å¼ã€‚</li>
</ul>
<h3 id="å®Œæ•´ç¤ºä¾‹"><a href="#å®Œæ•´ç¤ºä¾‹" class="headerlink" title="å®Œæ•´ç¤ºä¾‹"></a>å®Œæ•´ç¤ºä¾‹</h3><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨<code>/sdapi/v1/txt2img</code>ç«¯ç‚¹çš„å®Œæ•´ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¸¸ç”¨å‚æ•°çš„ç”¨æ³•ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®APIç«¯ç‚¹</span></span><br><span class="line">url = <span class="string">&quot;http://localhost:7860/sdapi/v1/txt2img&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®è¯·æ±‚æ•°æ®</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;prompt&quot;</span>: <span class="string">&quot;a futuristic cityscape&quot;</span>,</span><br><span class="line">    <span class="string">&quot;steps&quot;</span>: <span class="number">30</span>,</span><br><span class="line">    <span class="string">&quot;sampler_index&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="string">&quot;cfg_scale&quot;</span>: <span class="number">10.0</span>,</span><br><span class="line">    <span class="string">&quot;seed&quot;</span>: <span class="number">42</span>,</span><br><span class="line">    <span class="string">&quot;height&quot;</span>: <span class="number">512</span>,</span><br><span class="line">    <span class="string">&quot;width&quot;</span>: <span class="number">512</span>,</span><br><span class="line">    <span class="string">&quot;batch_size&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&quot;n_iter&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&quot;negative_prompt&quot;</span>: <span class="string">&quot;no people, no animals&quot;</span>,</span><br><span class="line">    <span class="string">&quot;eta&quot;</span>: <span class="number">0.0</span>,</span><br><span class="line">  	<span class="string">&quot;ckpt&quot;</span>: <span class="string">&quot;models/Stable-diffusion/model1.ckpt&quot;</span>  <span class="comment"># æŒ‡å®šæ¨¡å‹è·¯å¾„</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘é€POSTè¯·æ±‚</span></span><br><span class="line">response = requests.post(url, headers=&#123;<span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>&#125;, data=json.dumps(data))</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°å“åº”</span></span><br><span class="line"><span class="built_in">print</span>(response.json())</span><br></pre></td></tr></table></figure>

<h3 id="APIç«¯ç‚¹"><a href="#APIç«¯ç‚¹" class="headerlink" title="APIç«¯ç‚¹"></a>APIç«¯ç‚¹</h3><ol>
<li><code>/sdapi/v1/txt2img</code>: åŸºäºæ–‡æœ¬æç¤ºç”Ÿæˆå›¾åƒã€‚</li>
<li><code>/sdapi/v1/img2img</code>: åŸºäºè¾“å…¥å›¾åƒå’Œæ–‡æœ¬æç¤ºç”Ÿæˆæ–°å›¾åƒã€‚</li>
<li><code>/sdapi/v1/extra</code>: æ‰§è¡Œé¢å¤–çš„å›¾åƒå¤„ç†ä»»åŠ¡ã€‚</li>
</ol>
<h3 id="å‚æ•°è¯´æ˜æ€»ç»“"><a href="#å‚æ•°è¯´æ˜æ€»ç»“" class="headerlink" title="å‚æ•°è¯´æ˜æ€»ç»“"></a>å‚æ•°è¯´æ˜æ€»ç»“</h3><ul>
<li><strong><code>prompt</code></strong>: è¾“å…¥çš„æ–‡æœ¬æè¿°ã€‚</li>
<li><strong><code>steps</code></strong>: é‡‡æ ·æ­¥éª¤æ•°ã€‚</li>
<li><strong><code>sampler_index</code></strong>: é‡‡æ ·æ–¹æ³•ç´¢å¼•ã€‚</li>
<li><strong><code>cfg_scale</code></strong>: Classifier-Free Guidanceæ¯”ä¾‹ã€‚</li>
<li><strong><code>seed</code></strong>: éšæœºç§å­ã€‚</li>
<li><strong><code>height</code></strong>: å›¾åƒé«˜åº¦ã€‚</li>
<li><strong><code>width</code></strong>: å›¾åƒå®½åº¦ã€‚</li>
<li><strong><code>batch_size</code></strong>: æ‰¹é‡ç”Ÿæˆæ•°é‡ã€‚</li>
<li><strong><code>n_iter</code></strong>: ç”Ÿæˆè¿­ä»£æ¬¡æ•°ã€‚</li>
<li><strong><code>negative_prompt</code></strong>: è´Ÿé¢æç¤ºã€‚</li>
<li><strong><code>eta</code></strong>: DDIMé‡‡æ ·ä¸­çš„etaå‚æ•°ã€‚</li>
<li><strong><code>init_images</code></strong>: è¾“å…¥å›¾åƒåˆ—è¡¨ï¼ˆç”¨äºimg2imgï¼‰ã€‚</li>
<li><strong><code>denoising_strength</code></strong>: é™å™ªå¼ºåº¦ï¼ˆç”¨äºimg2imgï¼‰ã€‚</li>
<li><strong><code>mask</code></strong>: æ©ç å›¾åƒã€‚</li>
<li><strong><code>inpainting_fill</code></strong>: ä¿®è¡¥å¡«å……æ–¹å¼ã€‚</li>
</ul>
<p>é€šè¿‡è¿™äº›å‚æ•°ï¼Œä½ å¯ä»¥é«˜åº¦è‡ªå®šä¹‰å›¾åƒç”Ÿæˆè¿‡ç¨‹ï¼Œæ»¡è¶³å„ç§åº”ç”¨éœ€æ±‚ã€‚å¦‚æœä½ æœ‰ä»»ä½•å…¶ä»–é—®é¢˜æˆ–éœ€è¦æ›´è¯¦ç»†çš„è¯´æ˜ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ã€‚</p>
<h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><p>ä»¿æ¢µé«˜çš„å‘æ—¥è‘µ</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;prompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vg,&lt;lora:vgv1-000009:0.9&gt;,vibrant sunflowers chasing the sun,details,&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;negative_prompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;easynegative bad-hands-5,&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;steps&quot;</span><span class="punctuation">:</span> <span class="number">20</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;cfg_scale&quot;</span><span class="punctuation">:</span> <span class="number">7.0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;height&quot;</span><span class="punctuation">:</span> <span class="number">1024</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;width&quot;</span><span class="punctuation">:</span> <span class="number">512</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sampler_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;DPM++ 2M SDE&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>ä»¿è«å¥ˆçš„ç¡è²</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;prompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&lt;lora:monet_v2-000004:1&gt;,painting (medium), lake, water lilies&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;negative_prompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sketches, out of frame, lowres, text, error, cropped, worst quality, low quality, jpeg artifacts, ugly, duplicate, morbid, mutilated, out of frame, extra fingers, mutated hands, poorly drawn hands, poorly drawn face, mutation, deformed, blurry, dehydrated, bad anatomy, bad proportions, extra limbs, cloned face, disfigured, gross proportions, malformed limbs, missing arms, missing legs, extra arms, extra legs, fused fingers, too many fingers, long neck, username, watermark, signature&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;steps&quot;</span><span class="punctuation">:</span> <span class="number">50</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;cfg_scale&quot;</span><span class="punctuation">:</span> <span class="number">7.0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;height&quot;</span><span class="punctuation">:</span> <span class="number">1024</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;width&quot;</span><span class="punctuation">:</span> <span class="number">512</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sampler_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;DPM++ 2M SDE&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="BUG-2"><a href="#BUG-2" class="headerlink" title="BUG"></a>BUG</h3><p>è®¿é—®åå‡ºç°ä¸‹é¢çš„è¿”å›</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="string">&quot;detail&quot;</span>: <span class="string">&quot;Not Found&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‚è€ƒè§£å†³ï¼š[<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/AUTOMATIC1111/stable-diffusion-webui/issues/13279">é”™è¯¯]ï¼šæˆ‘æ²¡æœ‰ &#x2F;sdapi&#x2F;v1&#x2F;txt2img åœ¨ç¨³å®šæ‰©æ•£ä¸­å¡«å…… Â·é—®é¢˜ #13279 Â·AUTOMATIC1111&#x2F;stable-diffusion-webui (github.com)</a></p>
<p>è¿™æ˜¯ç«¯å£é—®é¢˜å¯¼è‡´çš„BUGï¼ŒglmæŠŠ7860ç«¯å£å äº†ï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨7861ç«¯å£ï¼Œä»¥åè¦æ˜¯æ— æ³•å¯åŠ¨ï¼Œæ³¨æ„è§‚å¯Ÿç»ˆç«¯ç«¯å£è¾“å‡º</p>
<h2 id="è·å–å›¾ç‰‡è¿›åº¦API"><a href="#è·å–å›¾ç‰‡è¿›åº¦API" class="headerlink" title="è·å–å›¾ç‰‡è¿›åº¦API"></a>è·å–å›¾ç‰‡è¿›åº¦API</h2><p>ç›®å‰çŒœæµ‹å®ç°æ–¹å¼æ˜¯ï¼Œåœ¨è¿›è¡Œæ–‡ç”Ÿå›¾APIåï¼Œé©¬ä¸Šè°ƒç”¨<code>http://127.0.0.1:7860/sdapi/v1/progress?skip_current_image=false</code></p>
<p>è¿™ä¸ªAPIï¼Œæ¯ç§’è®¿é—®ä¸€æ¬¡ï¼Œä¸è¿‡è¿™ä¸ªå‚æ•°<code>skip_current_image</code>å«ä¹‰ï¼Œè¿˜å¾—åˆ°æ—¶å€™å†è¯•è¯•</p>
<h1 id="UbuntuæœåŠ¡å™¨ç«¯é…ç½®å¤–ç½‘è®¿é—®"><a href="#UbuntuæœåŠ¡å™¨ç«¯é…ç½®å¤–ç½‘è®¿é—®" class="headerlink" title="UbuntuæœåŠ¡å™¨ç«¯é…ç½®å¤–ç½‘è®¿é—®"></a>UbuntuæœåŠ¡å™¨ç«¯é…ç½®å¤–ç½‘è®¿é—®</h1><p>ä½¿ç”¨<code>clash</code>è¿›è¡Œé…ç½®ï¼Œç”±äºå®˜æ–¹çš„é¡¹ç›®å·²ç»è·‘è·¯ï¼Œè¿™é‡Œé€‰æ‹©çš„é¡¹ç›®ä¸º:</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Elegycloud/clash-for-linux-backup">Elegycloud&#x2F;clash-for-linux-backup: åŸºäºClash Core åˆ¶ä½œçš„Clash For Linuxå¤‡ä»½ä»“åº“ A Clash For Linux Backup Warehouse Based on Clash Core (github.com)</a></p>
<p>è¯¦ç»†å¯è§å’Œxycçš„èŠå¤©è®°å½•ï¼Œå“ªå¤©è‡ªå·±ä¹Ÿå†å»é…ç½®ä¸€ä¸‹</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://tecnb.github.io">TEC</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://tecnb.github.io/posts/41e32035.html">https://tecnb.github.io/posts/41e32035.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://tecnb.github.io" target="_blank">TEC</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/TECNB/picgodemo@main/img/Ubuntu%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%A4%A7%E6%A8%A1%E5%9E%8B-cover.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/4e8d76cd.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/TECNB/picgodemo@main/img/wallhaven-2y2ymx_2560x1440.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">ç«Ÿèµ›èŒèŠ½ä¹¦æ„é¡¹ç›®ç»éªŒ</div></div></a></div><div class="next-post pull-right"><a href="/posts/83a155e2.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.jsdelivr.net/gh/TECNB/picgodemo@main/img/wallhaven-9mjoy1_2560x1440.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">Expresså­¦ä¹ </div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="lv-container" data-id="city" data-uid="MTAyMC81NzY3OC8zNDE0MQ=="></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Ubuntu%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E9%83%A8%E7%BD%B2%E5%A4%A7%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.</span> <span class="toc-text">UbuntuæœåŠ¡å™¨ç«¯éƒ¨ç½²å¤§æ¨¡å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E7%94%A8Ollama"><span class="toc-number">1.1.</span> <span class="toc-text">è°ƒç”¨Ollama</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%90%AFollama%E6%9C%8D%E5%8A%A1%E7%AB%AF"><span class="toc-number">1.2.</span> <span class="toc-text">å¼€å¯ollamaæœåŠ¡ç«¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.3.</span> <span class="toc-text">ä¸‹è½½æ¨¡å‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E5%A4%A7%E6%A8%A1%E5%9E%8BWebUI"><span class="toc-number">1.4.</span> <span class="toc-text">è¿è¡Œå¤§æ¨¡å‹WebUI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BUG"><span class="toc-number">1.4.1.</span> <span class="toc-text">BUG</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%94%E5%9B%9E%E6%95%B0%E6%8D%AE"><span class="toc-number">1.5.</span> <span class="toc-text">é€šè¿‡æœåŠ¡å™¨è¿”å›æ•°æ®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%AE%E8%B0%83%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.6.</span> <span class="toc-text">å¾®è°ƒæ¨¡å‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#API%E8%B0%83%E7%94%A8"><span class="toc-number">1.7.</span> <span class="toc-text">APIè°ƒç”¨</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Ubuntu%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E9%83%A8%E7%BD%B2Stable-Diffusion"><span class="toc-number">2.</span> <span class="toc-text">UbuntuæœåŠ¡å™¨ç«¯éƒ¨ç½²Stable Diffusion</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">2.1.</span> <span class="toc-text">å®‰è£…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8"><span class="toc-number">2.2.</span> <span class="toc-text">å¯åŠ¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E6%8A%A5%E9%94%99"><span class="toc-number">2.2.1.</span> <span class="toc-text">å¯åŠ¨æŠ¥é”™</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE"><span class="toc-number">2.3.</span> <span class="toc-text">è®¿é—®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E6%89%A9%E5%B1%95"><span class="toc-number">2.4.</span> <span class="toc-text">æ·»åŠ æ‰©å±•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E4%B8%AD%E6%96%87%E5%92%8C%E5%8F%8C%E8%AF%AD%E7%95%8C%E9%9D%A2"><span class="toc-number">2.4.1.</span> <span class="toc-text">å®‰è£…ä¸­æ–‡å’ŒåŒè¯­ç•Œé¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BUG-1"><span class="toc-number">2.4.2.</span> <span class="toc-text">BUG</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%A7%E6%A8%A1%E5%9E%8B%EF%BC%88%E5%9F%BA%E5%BA%A7%E6%A8%A1%E5%9E%8B%EF%BC%8C%E5%BA%95%E6%A8%A1%EF%BC%89%E6%B7%BB%E5%8A%A0"><span class="toc-number">2.5.</span> <span class="toc-text">å¤§æ¨¡å‹ï¼ˆåŸºåº§æ¨¡å‹ï¼Œåº•æ¨¡ï¼‰æ·»åŠ </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E7%94%9F%E5%9B%BEAPI%E5%8F%82%E6%95%B0%E8%B0%83%E6%95%B4"><span class="toc-number">2.6.</span> <span class="toc-text">æ–‡ç”Ÿå›¾APIå‚æ•°è°ƒæ•´</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E5%8F%82%E6%95%B0"><span class="toc-number">2.6.1.</span> <span class="toc-text">é€šç”¨å‚æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%AE%9A%E5%8F%82%E6%95%B0"><span class="toc-number">2.6.2.</span> <span class="toc-text">ç‰¹å®šå‚æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E7%A4%BA%E4%BE%8B"><span class="toc-number">2.6.3.</span> <span class="toc-text">å®Œæ•´ç¤ºä¾‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#API%E7%AB%AF%E7%82%B9"><span class="toc-number">2.6.4.</span> <span class="toc-text">APIç«¯ç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E%E6%80%BB%E7%BB%93"><span class="toc-number">2.6.5.</span> <span class="toc-text">å‚æ•°è¯´æ˜æ€»ç»“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90"><span class="toc-number">2.6.6.</span> <span class="toc-text">ä¾‹å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BUG-2"><span class="toc-number">2.6.7.</span> <span class="toc-text">BUG</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87%E8%BF%9B%E5%BA%A6API"><span class="toc-number">2.7.</span> <span class="toc-text">è·å–å›¾ç‰‡è¿›åº¦API</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Ubuntu%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E9%85%8D%E7%BD%AE%E5%A4%96%E7%BD%91%E8%AE%BF%E9%97%AE"><span class="toc-number">3.</span> <span class="toc-text">UbuntuæœåŠ¡å™¨ç«¯é…ç½®å¤–ç½‘è®¿é—®</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By TEC</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadLivere () {
  if (typeof LivereTower === 'object') {
    window.LivereTower.init()
  }
  else {
    (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
    })(document, 'script');
  }
}

if ('Livere' === 'Livere' || !false) {
  if (false) btf.loadComment(document.getElementById('lv-container'), loadLivere)
  else loadLivere()
}
else {
  function loadOtherComment () {
    loadLivere()
  }
}</script></div><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><div class="aplayer no-destroy" data-id="7766753897" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true"> </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>